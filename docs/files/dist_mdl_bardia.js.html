<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>dist\mdl\bardia.js - Bardia</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Bardia" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/bardia.layout.BorderLayout.html">bardia.layout.BorderLayout</a></li>
                                <li><a href="../classes/bardia.layout.Material.html">bardia.layout.Material</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: dist\mdl\bardia.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * JavaScriptUtil is a part of JavaScripTools (http://javascriptools.sourceforge.net).
 * This file was compressed using JavaScriptZip (http://javascriptzip.sourceforge.net).
 * Author: Luis Fernando Planella Gonzalez (lfpg.dev at gmail dot com)
 * Version: 2.2.5
 * JavaScripTools is distributed under the GNU Lesser General Public License (LGPL).
 * For more information, see http://www.gnu.org/licenses/lgpl-2.1.txt
*/
var JST_CHARS_NUMBERS=&quot;0123456789&quot;;var JST_CHARS_LOWER=&quot;&quot;;var JST_CHARS_UPPER=&quot;&quot;;for(var i=50;i&lt;500;i++){var c=String.fromCharCode(i);var lower=c.toLowerCase();var upper=c.toUpperCase();if(lower!=upper){JST_CHARS_LOWER+=lower;JST_CHARS_UPPER+=upper}}
var JST_CHARS_LETTERS=JST_CHARS_LOWER+JST_CHARS_UPPER;var JST_CHARS_ALPHA=JST_CHARS_LETTERS+JST_CHARS_NUMBERS;var JST_CHARS_BASIC_LOWER=&quot;abcdefghijklmnopqrstuvwxyz&quot;;var JST_CHARS_BASIC_UPPER=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;var JST_CHARS_BASIC_LETTERS=JST_CHARS_BASIC_LOWER+JST_CHARS_BASIC_UPPER;var JST_CHARS_BASIC_ALPHA=JST_CHARS_BASIC_LETTERS+JST_CHARS_NUMBERS;var JST_CHARS_WHITESPACE=&quot; \t\n\r&quot;;var MILLIS_IN_SECOND=1000;var MILLIS_IN_MINUTE=60*MILLIS_IN_SECOND;var MILLIS_IN_HOUR=60*MILLIS_IN_MINUTE;var MILLIS_IN_DAY=24*MILLIS_IN_HOUR;var JST_FIELD_MILLISECOND=0;var JST_FIELD_SECOND=1;var JST_FIELD_MINUTE=2;var JST_FIELD_HOUR=3;var JST_FIELD_DAY=4;var JST_FIELD_MONTH=5;var JST_FIELD_YEAR=6;
function getObject(objectName,source){if(isEmpty(objectName)){return null}
if(!isInstance(objectName,String)){return objectName}
if(isEmpty(source)){source=self}
if(isInstance(source,String)){sourceName=source;source=self.frames[sourceName];if(source==null) source=parent.frames[sourceName];if(source==null) source=top.frames[sourceName];if(source==null) source=getObject(sourceName);if(source==null) return null}
var document=(source.document)?source.document:source;if(document.getElementById){var collection=document.getElementsByName(objectName);if(collection.length==1) return collection[0];if(collection.length&gt;1){if(typeof(collection)==&quot;array&quot;){return collection}
var ret=new Array(collection.length);for(var i=0;i&lt;collection.length;i++){ret[i]=collection[i]}
return ret}
return document.getElementById(objectName)} else {if(document[objectName]) return document[objectName];if(document.all[objectName]) return document.all[objectName];if(source[objectName]) return source[objectName]}
return null}
function isInstance(object,clazz){if((object==null)||(clazz==null)){return false}
if(object instanceof clazz){return true}
if((clazz==String)&amp;&amp;(typeof(object)==&quot;string&quot;)){return true}
if((clazz==Number)&amp;&amp;(typeof(object)==&quot;number&quot;)){return true}
if((clazz==Array)&amp;&amp;(typeof(object)==&quot;array&quot;)){return true}
if((clazz==Function)&amp;&amp;(typeof(object)==&quot;function&quot;)){return true}
var base=object.base;while(base!=null){if(base==clazz){return true}
base=base.base}
return false}
function booleanValue(object,trueChars){if(object==true||object==false){return object} else {object=String(object);if(object.length==0){return false} else {var first=object.charAt(0).toUpperCase();trueChars=isEmpty(trueChars)?&quot;T1YS&quot;:trueChars.toUpperCase();return trueChars.indexOf(first)!=-1
}}}
function isUndefined(object){return typeof(object)==&quot;undefined&quot;}
function invoke(functionName,args){var arguments;if(args==null||isUndefined(args)){arguments=&quot;()&quot;} else if(!isInstance(args,Array)){arguments=&quot;(args)&quot;} else {arguments=&quot;(&quot;;for(var i=0;i&lt;args.length;i++){if(i&gt;0){arguments+=&quot;,&quot;}
arguments+=&quot;args[&quot;+i+&quot;]&quot;}
arguments+=&quot;)&quot;}
return eval(functionName+arguments)}
function invokeAsMethod(object,method,args){return method.apply(object,args)}
function ensureArray(object){if(typeof(object)==&#x27;undefined&#x27;||object==null){return []}
if(object instanceof Array){return object}
return [object]}
function indexOf(object,array,startingAt){if((object==null)||!(array instanceof Array)){return-1}
if(startingAt==null){startingAt=0}
for(var i=startingAt;i&lt;array.length;i++){if(array[i]==object){return i}}
return-1}
function inArray(object,array){return indexOf(object,array)&gt;=0}
function removeFromArray(array){if(!isInstance(array,Array)){return null}
var ret=[];var toRemove=removeFromArray.arguments.slice(1);for(var i=0;i&lt;array.length;i++){var current=array[i];if(!inArray(current,toRemove)){ret[ret.length]=current}}
return ret}
function arrayConcat(){var ret=[];for(var i=0;i&lt;arrayConcat.arguments.length;i++){var current=arrayConcat.arguments[i];if(!isEmpty(current)){if(!isInstance(current,Array)){current=[current]
}
for(j=0;j&lt;current.length;j++){ret[ret.length]=current[j]}}}
return ret}
function arrayEquals(array1,array2){if(!isInstance(array1,Array)||!isInstance(array2,Array)){return false}
if(array1.length!=array2.length){return false}
for(var i=0;i&lt;array1.length;i++){if(array1[i]!=array2[i]){return false}}
return true}
function checkAll(object,flag){if(typeof(object)==&quot;string&quot;){object=getObject(object)}
if(object!=null){if(!isInstance(object,Array)){object=[object]}
for(i=0;i&lt;object.length;i++){object[i].checked=flag}}}
function observeEvent(object,eventName,handler){object=getObject(object);if(object!=null){if(object.addEventListener){object.addEventListener(eventName,function(e){return invokeAsMethod(object,handler,[e])},false)} else if(object.attachEvent){object.attachEvent(&quot;on&quot;+eventName,function(){return invokeAsMethod(object,handler,[window.event])})} else {object[&quot;on&quot;+eventName]=handler}}}
function typedCode(event){var code=0;if(event==null&amp;&amp;window.event){event=window.event}
if(event!=null){if(event.keyCode){code=event.keyCode} else if(event.which){code=event.which}}
return code}
function stopPropagation(event){if(event==null&amp;&amp;window.event){event=window.event}
if(event!=null){if(event.stopPropagation!=null){event.stopPropagation()} else if(event.cancelBubble!==null){event.cancelBubble=true}}
return false}
function preventDefault(event){if(event==null&amp;&amp;window.event){event=window.event}
if(event!=null){if(event.preventDefault!=null){event.preventDefault()} else if(event.returnValue!==null){event.returnValue=false}}
return false}
function prepareForCaret(object){object=getObject(object);if(object==null||!object.type){return null}
if(object.createTextRange){var handler=function(){object.caret=document.selection.createRange().duplicate()}
observeEvent(object,&quot;onclick&quot;,handler);observeEvent(object,&quot;ondblclick&quot;,handler);observeEvent(object,&quot;onselect&quot;,handler);observeEvent(object,&quot;onkeyup&quot;,handler)}}
function isCaretSupported(object){object=getObject(object);if(object==null||!object.type){return false}
if(navigator.userAgent.toLowerCase().indexOf(&quot;opera&quot;)&gt;=0){return false}
return object.setSelectionRange!=null||object.createTextRange!=null}
function isInputSelectionSupported(object){object=getObject(object);if(object==null||!object.type){return false}
return object.setSelectionRange!=null||object.createTextRange!=null}
function getInputSelection(object){object=getObject(object);if(object==null||!object.type){return null}
try {if(object.createTextRange&amp;&amp;object.caret){return object.caret.text} else if(object.setSelectionRange){var selStart=object.selectionStart;var selEnd=object.selectionEnd;return object.value.substring(selStart,selEnd)}} catch(e){}
return &quot;&quot;}
function getInputSelectionRange(object){object=getObject(object);if(object==null||!object.type){return null}
try {if(object.selectionEnd){return [object.selectionStart,object.selectionEnd]} else if(object.createTextRange&amp;&amp;object.caret){var end=getCaret(object);return [end-object.caret.text.length,end]}} catch(e){}
return null}
function setInputSelectionRange(object,start,end){object=getObject(object);if(object==null||!object.type){return}
try {if(start&lt;0){start=0}
if(end&gt;object.value.length){end=object.value.length}
if(object.setSelectionRange){object.focus();object.setSelectionRange(start,end)} else if(object.createTextRange){object.focus();var range;if(object.caret){range=object.caret;range.moveStart(&quot;textedit&quot;,-1);range.moveEnd(&quot;textedit&quot;,-1)} else {range=object.createTextRange()}
range.moveEnd(&#x27;character&#x27;,end);range.moveStart(&#x27;character&#x27;,start);range.select()}} catch(e){}}
function getCaret(object){object=getObject(object);if(object==null||!object.type){return null}
try {if(object.createTextRange&amp;&amp;object.caret){var range=object.caret.duplicate();range.moveStart(&#x27;textedit&#x27;,-1);return range.text.length} else if(object.selectionStart||object.selectionStart==0){return object.selectionStart}} catch(e){}
return null}
function setCaret(object,pos){setInputSelectionRange(object,pos,pos)}
function setCaretToEnd(object){object=getObject(object);if(object==null||!object.type){return}
try {if(object.createTextRange){var range=object.createTextRange();range.collapse(false);range.select()} else if(object.setSelectionRange){var length=object.value.length;object.setSelectionRange(length,length);object.focus()}} catch(e){}}
function setCaretToStart(object){object=getObject(object);if(object==null||!object.type){return}
try {if(object.createTextRange){var range=object.createTextRange();range.collapse(true);range.select()} else if(object.setSelectionRange){object.focus();object.setSelectionRange(0,0)}} catch(e){}}
function selectString(object,string){if(isInstance(object,String)){object=getObject(object)}
if(object==null||!object.type){return}
var match=new RegExp(string,&quot;i&quot;).exec(object.value);if(match){setInputSelectionRange(object,match.index,match.index+match[0].length)}}
function replaceSelection(object,string){object=getObject(object);if(object==null||!object.type){return}
if(object.setSelectionRange){var selectionStart=object.selectionStart;var selectionEnd=object.selectionEnd;object.value=object.value.substring(0,selectionStart)+string+object.value.substring(selectionEnd);if(selectionStart!=selectionEnd){setInputSelectionRange(object,selectionStart,selectionStart+string.length)} else {setCaret(object,selectionStart+string.length)}} else if(object.createTextRange&amp;&amp;object.caret){object.caret.text=string}}
function clearOptions(select){select=getObject(select);var ret=[];if(select!=null){for(var i=0;i&lt;select.options.length;i++){var option=select.options[i];ret[ret.length]=new Option(option.text,option.value)}
select.options.length=0}
return ret}
function addOption(select,option,sort,textProperty,valueProperty,selectedProperty){select=getObject(select);if(select==null||option==null){return}
textProperty=textProperty||&quot;text&quot;;valueProperty=valueProperty||&quot;value&quot;;selectedProperty=selectedProperty||&quot;selected&quot;
if(isInstance(option,Map)){option=option.toObject()}
if(isUndefined(option[valueProperty])){valueProperty=textProperty}
var selected=false;if(!isUndefined(option[selectedProperty])){selected=option[selectedProperty]}
option=new Option(option[textProperty],option[valueProperty],selected,selected);select.options[select.options.length]=option;if(booleanValue(sort)){sortOptions(select)}}
function addOptions(select,options,sort,textProperty,valueProperty,selectedProperty){select=getObject(select);if(select==null){return}
for(var i=0;i&lt;options.length;i++){addOption(select,options[i],false,textProperty,valueProperty,selectedProperty)}
if(!select.multiple&amp;&amp;select.selectedIndex&lt;0&amp;&amp;select.options.length&gt;0){select.selectedIndex=0}
if(booleanValue(sort)){sortOptions(select)}}
function compareOptions(opt1,opt2){if(opt1==null&amp;&amp;opt2==null){return 0}
if(opt1==null){return-1}
if(opt2==null){return 1}
if(opt1.text==opt2.text){return 0} else if(opt1.text&gt;opt2.text){return 1} else {return-1}}
function setOptions(select,options,addEmpty,sort,textProperty,valueProperty,selectedProperty){select=getObject(select);var ret=clearOptions(select);var addEmptyIsString=isInstance(addEmpty,String);if(addEmptyIsString||booleanValue(addEmpty)){select.options[0]=new Option(addEmptyIsString?addEmpty:&quot;&quot;)}
addOptions(select,options,sort,textProperty,valueProperty,selectedProperty);return ret}
function sortOptions(select,sortFunction){select=getObject(select);if(select==null){return}
var options=clearOptions(select);if(isInstance(sortFunction,Function)){options.sort(sortFunction)} else {options.sort(compareOptions)}
setOptions(select,options)}
function transferOptions(source,dest,all,sort){source=getObject(source);dest=getObject(dest);if(source==null||dest==null){return}
if(booleanValue(all)){addOptions(dest,clearOptions(source),sort)} else {var sourceOptions=[];var destOptions=[];for(var i=0;i&lt;source.options.length;i++){var option=source.options[i];var options=(option.selected)?destOptions:sourceOptions;options[options.length]=new Option(option.text,option.value)}
setOptions(source,sourceOptions,false,sort);addOptions(dest,destOptions,sort)}}
function getValue(object){object=getObject(object);if(object==null){return null}
if(object.length&amp;&amp;!object.type){var ret=[];for(var i=0;i&lt;object.length;i++){var temp=getValue(object[i]);if(temp!=null){ret[ret.length]=temp}}
return ret.length==0?null:ret.length==1?ret[0]:ret}
if(object.type){if(object.type.indexOf(&quot;select&quot;)&gt;=0){var ret=[];if(!object.multiple&amp;&amp;object.selectedIndex&lt;0&amp;&amp;object.options.length&gt;0){ret[ret.length]=object.options[0].value} else {for(i=0;i&lt;object.options.length;i++){var option=object.options[i];if(option.selected){ret[ret.length]=option.value;if(!object.multiple){break}}}}
return ret.length==0?null:ret.length==1?ret[0]:ret}
if(object.type==&quot;radio&quot;||object.type==&quot;checkbox&quot;){return booleanValue(object.checked)?object.value:null} else {return object.value}} else if(typeof(object.innerHTML)!=&quot;undefined&quot;){return object.innerHTML} else {return null}}
function setValue(object,value){if(object==null){return}
if(typeof(object)==&quot;string&quot;){object=getObject(object)}
var values=ensureArray(value);for(var i=0;i&lt;values.length;i++){values[i]=values[i]==null?&quot;&quot;:&quot;&quot;+values[i]}
if(object.length&amp;&amp;!object.type){while(values.length&lt;object.length){values[values.length]=&quot;&quot;}
for(var i=0;i&lt;object.length;i++){var obj=object[i];setValue(obj,inArray(obj.type,[&quot;checkbox&quot;,&quot;radio&quot;])?values:values[i])}
return}
if(object.type){if(object.type.indexOf(&quot;select&quot;)&gt;=0){for(var i=0;i&lt;object.options.length;i++){var option=object.options[i];option.selected=inArray(option.value,values)}
return} else if(object.type==&quot;radio&quot;||object.type==&quot;checkbox&quot;){object.checked=inArray(object.value,values);return} else {object.value=values.length==0?&quot;&quot;:values[0];return}} else if(typeof(object.innerHTML)!=&quot;undefined&quot;){object.innerHTML=values.length==0?&quot;&quot;:values[0]}}
function decode(object){var args=decode.arguments;for(var i=1;i&lt;args.length;i+=2){if(i&lt;args.length-1){if(args[i]==object){return args[i+1]}} else {return args[i]}}
return null}
function select(){var args=select.arguments;for(var i=0;i&lt;args.length;i+=2){if(i&lt;args.length-1){if(booleanValue(args[i])){return args[i+1]}} else {return args[i]}}
return null}
function isEmpty(object){return object==null||String(object)==&quot;&quot;||typeof(object)==&quot;undefined&quot;||(typeof(object)==&quot;number&quot;&amp;&amp;isNaN(object))}
function ifEmpty(object,emptyValue){return isEmpty(object)?emptyValue:object}
function ifNull(object,nullValue){return object==null?nullValue:object}
function replaceAll(string,find,replace){return String(string).split(find).join(replace)}
function repeat(string,times){var ret=&quot;&quot;;for(var i=0;i&lt;Number(times);i++){ret+=string}
return ret}
function ltrim(string,chars){string=string?String(string):&quot;&quot;;chars=chars||JST_CHARS_WHITESPACE;var pos=0;while(chars.indexOf(string.charAt(pos))&gt;=0&amp;&amp;(pos&lt;=string.length)){pos++}
return string.substr(pos)}
function rtrim(string,chars){string=string?String(string):&quot;&quot;;chars=chars||JST_CHARS_WHITESPACE;var pos=string.length-1;while(chars.indexOf(string.charAt(pos))&gt;=0&amp;&amp;(pos&gt;=0)){pos--}
return string.substring(0,pos+1)}
function trim(string,chars){chars=chars||JST_CHARS_WHITESPACE;return ltrim(rtrim(string,chars),chars)}
function lpad(string,size,chr){string=String(string);if(size&lt;0){return &quot;&quot;}
if(isEmpty(chr)){chr=&quot; &quot;} else {chr=String(chr).charAt(0)}
while(string.length&lt;size){string=chr+string}
return left(string,size)}
function rpad(string,size,chr){string=String(string);if(size&lt;=0){return &quot;&quot;}
chr=String(chr);if(isEmpty(chr)){chr=&quot; &quot;} else {chr=chr.charAt(0)}
while(string.length&lt;size){string+=chr}
return left(string,size)}
function crop(string,pos,size){string=String(string);if(size==null){size=1}
if(size&lt;=0){return &quot;&quot;}
return left(string,pos)+mid(string,pos+size)}
function lcrop(string,size){if(size==null){size=1}
return crop(string,0,size)}
function rcrop(string,size){string=String(string);if(size==null){size=1}
return crop(string,string.length-size,size)}
function capitalize(text,separators){text=String(text);separators=separators||JST_CHARS_WHITESPACE+&#x27;.?!&#x27;;var out=&quot;&quot;;var last=&#x27;&#x27;;for(var i=0;i&lt;text.length;i++){var current=text.charAt(i);if(separators.indexOf(last)&gt;=0){out+=current.toUpperCase()} else {out+=current.toLowerCase()}
last=current}
return out}
function onlySpecified(string,possible){string=String(string);possible=String(possible);for(var i=0;i&lt;string.length;i++){if(possible.indexOf(string.charAt(i))==-1){return false}}
return true}
function onlyNumbers(string){return onlySpecified(string,JST_CHARS_NUMBERS)}
function onlyLetters(string){return onlySpecified(string,JST_CHARS_LETTERS)}
function onlyAlpha(string){return onlySpecified(string,JST_CHARS_ALPHA)}
function onlyBasicLetters(string){return onlySpecified(string,JST_CHARS_BASIC_LETTERS)}
function onlyBasicAlpha(string){return onlySpecified(string,JST_CHARS_BASIC_ALPHA)}
function left(string,n){string=String(string);return string.substring(0,n)}
function right(string,n){string=String(string);return string.substr(string.length-n)}
function mid(string,pos,n){string=String(string);if(n==null){n=string.length}
return string.substring(pos,pos+n)}
function insertString(string,pos,value){string=String(string);var prefix=left(string,pos);var suffix=mid(string,pos)
return prefix+value+suffix}
function functionName(funct,unnamed){if(typeof(funct)==&quot;function&quot;){var src=funct.toString();var start=src.indexOf(&quot;function&quot;);var end=src.indexOf(&quot;(&quot;);if((start&gt;=0)&amp;&amp;(end&gt;=0)){start+=8;var name=trim(src.substring(start,end));return isEmpty(name)?(unnamed||&quot;[unnamed]&quot;):name}} if(typeof(funct)==&quot;object&quot;){return functionName(funct.constructor)}
return null}
function debug(object,separator,sort,includeObject,objectSeparator){if(object==null){return &quot;null&quot;}
sort=booleanValue(sort==null?true:sort);includeObject=booleanValue(includeObject==null?true:sort);separator=separator||&quot;\n&quot;;objectSeparator=objectSeparator||&quot;--------------------&quot;;var properties=[];for(var property in object){var part=property+&quot; = &quot;;try {part+=object[property]} catch(e){part+=&quot;&lt;Error retrieving value&gt;&quot;}
properties[properties.length]=part}
if(sort){properties.sort()}
var out=&quot;&quot;;if(includeObject){try {out=object.toString()+separator} catch(e){out=&quot;&lt;Error calling the toString() method&gt;&quot;
}
if(!isEmpty(objectSeparator)){out+=objectSeparator+separator}}
out+=properties.join(separator);return out}
function escapeCharacters(string,extraChars,onlyExtra){var ret=String(string);extraChars=String(extraChars||&quot;&quot;);onlyExtra=booleanValue(onlyExtra);if(!onlyExtra){ret=replaceAll(ret,&quot;\n&quot;,&quot;\\n&quot;);ret=replaceAll(ret,&quot;\r&quot;,&quot;\\r&quot;);ret=replaceAll(ret,&quot;\t&quot;,&quot;\\t&quot;);ret=replaceAll(ret,&quot;\&quot;&quot;,&quot;\\\&quot;&quot;);ret=replaceAll(ret,&quot;\&#x27;&quot;,&quot;\\\&#x27;&quot;);ret=replaceAll(ret,&quot;\\&quot;,&quot;\\\\&quot;)}
for(var i=0;i&lt;extraChars.length;i++){var chr=extraChars.charAt(i);ret=replaceAll(ret,chr,&quot;\\\\u&quot;+lpad(new Number(chr.charCodeAt(0)).toString(16),4,&#x27;0&#x27;))}
return ret}
function unescapeCharacters(string,onlyExtra){var ret=String(string);var pos=-1;var u=&quot;\\\\u&quot;;onlyExtra=booleanValue(onlyExtra);do {pos=ret.indexOf(u);if(pos&gt;=0){var charCode=parseInt(ret.substring(pos+u.length,pos+u.length+4),16);ret=replaceAll(ret,u+charCode,String.fromCharCode(charCode))}} while(pos&gt;=0);if(!onlyExtra){ret=replaceAll(ret,&quot;\\n&quot;,&quot;\n&quot;);ret=replaceAll(ret,&quot;\\r&quot;,&quot;\r&quot;);ret=replaceAll(ret,&quot;\\t&quot;,&quot;\t&quot;);ret=replaceAll(ret,&quot;\\\&quot;&quot;, &quot;\&quot;&quot;);ret=replaceAll(ret,&quot;\\\&#x27;&quot;,&quot;\&#x27;&quot;);ret=replaceAll(ret,&quot;\\\\&quot;,&quot;\\&quot;)}
return ret}
function writeCookie(name,value,document,expires,path,domain,secure){document=document||self.document;var str=name+&quot;=&quot;+(isEmpty(value)?&quot;&quot;:encodeURIComponent(value));if(path!=null) str+=&quot;; path=&quot;+path;if(domain!=null) str+=&quot;; domain=&quot;+domain;if(secure!=null&amp;&amp;booleanValue(secure)) str+=&quot;; secure&quot;;if(expires===false) expires=new Date(2500,12,31);if(expires instanceof Date) str+=&quot;; expires=&quot;+expires.toGMTString();document.cookie=str}
function readCookie(name,document){document=document||self.document;var prefix=name+&quot;=&quot;;var cookie=document.cookie;var begin=cookie.indexOf(&quot;; &quot;+prefix);if(begin==-1){begin=cookie.indexOf(prefix);if(begin!=0) return null} else
begin+=2;var end=cookie.indexOf(&quot;;&quot;,begin);if(end==-1)
end=cookie.length;return decodeURIComponent(cookie.substring(begin+prefix.length,end))}
function deleteCookie(name,document,path,domain){writeCookie(name,null,document,path,domain)}
function getDateField(date,field){if(!isInstance(date,Date)){return null}
switch(field){case JST_FIELD_MILLISECOND:return date.getMilliseconds();case JST_FIELD_SECOND:return date.getSeconds();case JST_FIELD_MINUTE:return date.getMinutes();case JST_FIELD_HOUR:return date.getHours();case JST_FIELD_DAY:return date.getDate();case JST_FIELD_MONTH:return date.getMonth();case JST_FIELD_YEAR:return date.getFullYear()}
return null}
function setDateField(date,field,value){if(!isInstance(date,Date)){return}
switch(field){case JST_FIELD_MILLISECOND:date.setMilliseconds(value);break;case JST_FIELD_SECOND:date.setSeconds(value);break;case JST_FIELD_MINUTE:date.setMinutes(value);break;case JST_FIELD_HOUR:date.setHours(value);break;case JST_FIELD_DAY:date.setDate(value);break;case JST_FIELD_MONTH:date.setMonth(value);break;case JST_FIELD_YEAR:date.setFullYear(value);break}}
function dateAdd(date,amount,field){if(!isInstance(date,Date)){return null}
if(amount==0){return new Date(date.getTime())}
if(!isInstance(amount,Number)){amount=1}
if(field==null) field=JST_FIELD_DAY;if(field&lt;0||field&gt;JST_FIELD_YEAR){return null}
var time=date.getTime();if(field&lt;=JST_FIELD_DAY){var mult=1;switch(field){case JST_FIELD_SECOND:mult=MILLIS_IN_SECOND;break;case JST_FIELD_MINUTE:mult=MILLIS_IN_MINUTE;break;case JST_FIELD_HOUR:mult=MILLIS_IN_HOUR;break;case JST_FIELD_DAY:mult=MILLIS_IN_DAY;break}
var time=date.getTime();time+=mult*amount;return new Date(time)}
var ret=new Date(time);var day=ret.getDate();var month=ret.getMonth();var year=ret.getFullYear();if(field==JST_FIELD_YEAR){year+=amount} else if(field==JST_FIELD_MONTH){month+=amount}
while(month&gt;11){month-=12;year++}
day=Math.min(day,getMaxDay(month,year));ret.setDate(day);ret.setMonth(month);ret.setFullYear(year);return ret}
function dateDiff(date1,date2,field){if(!isInstance(date1,Date)||!isInstance(date2,Date)){return null}
if(field==null) field=JST_FIELD_DAY;if(field&lt;0||field&gt;JST_FIELD_YEAR){return null}
if(field&lt;=JST_FIELD_DAY){var div=1;switch(field){case JST_FIELD_SECOND:div=MILLIS_IN_SECOND;break;case JST_FIELD_MINUTE:div=MILLIS_IN_MINUTE;break;case JST_FIELD_HOUR:div=MILLIS_IN_HOUR;break;case JST_FIELD_DAY:div=MILLIS_IN_DAY;break}
return Math.round((date2.getTime()-date1.getTime())/div)}
var years=date2.getFullYear()-date1.getFullYear();if(field==JST_FIELD_YEAR){return years} else if(field==JST_FIELD_MONTH){var months1=date1.getMonth();var months2=date2.getMonth();if(years&lt;0){months1+=Math.abs(years)*12} else if(years&gt;0){months2+=years*12}
return(months2-months1)}
return null}
function truncDate(date,field){if(!isInstance(date,Date)){return null}
if(field==null) field=JST_FIELD_DAY;if(field&lt;0||field&gt;JST_FIELD_YEAR){return null}
var ret=new Date(date.getTime());if(field&gt;JST_FIELD_MILLISECOND){ret.setMilliseconds(0)}
if(field&gt;JST_FIELD_SECOND){ret.setSeconds(0)}
if(field&gt;JST_FIELD_MINUTE){ret.setMinutes(0)}
if(field&gt;JST_FIELD_HOUR){ret.setHours(0)}
if(field&gt;JST_FIELD_DAY){ret.setDate(1)}
if(field&gt;JST_FIELD_MONTH){ret.setMonth(0)}
return ret}
function getMaxDay(month,year){month=new Number(month)+1;year=new Number(year);switch(month){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 4:case 6:case 9:case 11:return 30;case 2:if((year%4)==0){return 29} else {return 28}
default:return 0}}
function getFullYear(year){year=Number(year);if(year&lt;1000){if(year&lt;50||year&gt;100){year+=2000} else {year+=1900}}
return year}
function setOpacity(object,value){object=getObject(object);if(object==null){return}
value=Math.round(Number(value));if(isNaN(value)||value&gt;100){value=100}
if(value&lt;0){value=0}
var style=object.style;if(style==null){return}
style.MozOpacity=value/100;style.filter=&quot;alpha(opacity=&quot;+value+&quot;)&quot;}
function getOpacity(object){object=getObject(object);if(object==null){return}
var style=object.style;if(style==null){return}
if(style.MozOpacity){return Math.round(style.MozOpacity*100)} else if(style.filter){var regExp=new RegExp(&quot;alpha\\(opacity=(\d*)\\)&quot;);var array=regExp.exec(style.filter);if(array!=null&amp;&amp;array.length&gt;1){return parseInt(array[1],10)}}
return 100}
function Pair(key,value){this.key=key==null?&quot;&quot;:key;this.value=value;
this.toString=function(){return this.key+&quot;=&quot;+this.value}}
function Value(key,value){this.base=Pair;this.base(key,value)}
function Map(pairs){this.pairs=pairs||[];this.afterSet=null;this.afterRemove=null;
this.putValue=function(pair){this.putPair(pair)}
this.putPair=function(pair){if(isInstance(pair,Pair)){for(var i=0;i&lt;this.pairs.length;i++){if(this.pairs[i].key==pair.key){this.pairs[i].value=pair.value}}
this.pairs[this.pairs.length]=pair;if(this.afterSet!=null){this.afterSet(pair,this)}}}
this.put=function(key,value){this.putValue(new Pair(key,value))}
this.putAll=function(map){if(!(map instanceof Map)){return}
var entries=map.getEntries();for(var i=0;i&lt;entries.length;i++){this.putPair(entries[i])}}
this.size=function(){return this.pairs.length}
this.get=function(key){for(var i=0;i&lt;this.pairs.length;i++){var pair=this.pairs[i];if(pair.key==key){return pair.value}}
return null}
this.getKeys=function(){var ret=[];for(var i=0;i&lt;this.pairs.length;i++){ret[ret.length]=this.pairs[i].key}
return ret}
this.getValues=function(){var ret=[];for(var i=0;i&lt;this.pairs.length;i++){ret[ret.length]=this.pairs[i].value}
return ret}
this.getEntries=function(){return this.getPairs()}
this.getPairs=function(){var ret=[];for(var i=0;i&lt;this.pairs.length;i++){ret[ret.length]=this.pairs[i]}
return ret}
this.remove=function(key){for(var i=0;i&lt;this.pairs.length;i++){var pair=this.pairs[i];if(pair.key==key){this.pairs.splice(i,1);if(this.afterRemove!=null){this.afterRemove(pair,this)}
return pair}}
return null}
this.clear=function(key){var ret=this.pairs;for(var i=0;i&lt;ret.length;i++){this.remove(ret[i].key)}
return ret}
this.toString=function(){return functionName(this.constructor)+&quot;: {&quot;+this.pairs+&quot;}&quot;}
this.toObject=function(){ret={};for(var i=0;i&lt;this.pairs.length;i++){var pair=this.pairs[i];ret[pair.key]=pair.value}
return ret}}
function StringMap(string,nameSeparator,valueSeparator,isEncoded){this.nameSeparator=nameSeparator||&quot;&amp;&quot;;this.valueSeparator=valueSeparator||&quot;=&quot;;this.isEncoded=isEncoded==null?true:booleanValue(isEncoded);var pairs=[];string=trim(string);if(!isEmpty(string)){var namesValues=string.split(nameSeparator);for(i=0;i&lt;namesValues.length;i++){var nameValue=namesValues[i].split(valueSeparator);var name=trim(nameValue[0]);var value=&quot;&quot;;if(nameValue.length&gt;0){value=trim(nameValue[1]);if(this.isEncoded){value=decodeURIComponent(value)}}
var pos=-1;for(j=0;j&lt;pairs.length;j++){if(pairs[j].key==name){pos=j;break}}
if(pos&gt;=0){var array=pairs[pos].value;if(!isInstance(array,Array)){array=[array]}
array[array.length]=value;pairs[pos].value=array} else {pairs[pairs.length]=new Pair(name,value)}}}
this.base=Map;this.base(pairs);
this.getString=function(){var ret=[];for(var i=0;i&lt;this.pairs.length;i++){var pair=this.pairs[i];ret[ret.length]=pair.key+this.valueSeparator+this.value}
return ret.join(this.nameSeparator)}}
function QueryStringMap(location){this.location=location||self.location;var string=String(this.location.search);if(!isEmpty(string)){string=string.substr(1)}
this.base=StringMap;this.base(string,&quot;&amp;&quot;,&quot;=&quot;,true);this.putPair=function(){alert(&quot;Cannot put a value on a query string&quot;)}
this.remove=function(){alert(&quot;Cannot remove a value from a query string&quot;)}}
function CookieMap(document){this.document=document||self.document;this.base=StringMap;this.base(document.cookie,&quot;;&quot;,&quot;=&quot;,true);this.afterSet=function(pair){writeCookie(pair.key,pair.value,this.document)}
this.afterRemove=function(pair){deleteCookie(pair.key,this.document)}}
function ObjectMap(object){this.object=object;var pairs=[];for(var property in this.object){pairs[pairs.length]=new Pair(property,this.object[property])}
this.base=Map;this.base(pairs);this.afterSet=function(pair){this.object[pair.key]=pair.value}
this.afterRemove=function(pair){try {delete object[pair.key]} catch(exception){object[pair.key]=null}}}
function StringBuffer(initialCapacity){this.initialCapacity=initialCapacity||10;this.buffer=new Array(this.initialCapacity);this.append=function(value){this.buffer[this.buffer.length]=value;return this}
this.clear=function(){delete this.buffer;this.buffer=new Array(this.initialCapacity)}
this.toString=function(){return this.buffer.join(&quot;&quot;)}
this.length=function(){return this.toString().length}}
/*
 * InputMask is a part of JavaScripTools (http://javascriptools.sourceforge.net).
 * This file was compressed using JavaScriptZip (http://javascriptzip.sourceforge.net).
 * Author: Luis Fernando Planella Gonzalez (lfpg.dev at gmail dot com)
 * Version: 2.2.5
 * JavaScripTools is distributed under the GNU Lesser General Public License (LGPL).
 * For more information, see http://www.gnu.org/licenses/lgpl-2.1.txt
*/
var JST_NUMBER_MASK_APPLY_ON_BACKSPACE=true;var JST_MASK_VALIDATE_ON_BLUR=true;var JST_DEFAULT_ALLOW_NEGATIVE=true;var JST_DEFAULT_LEFT_TO_RIGHT=false;var JST_DEFAULT_DATE_MASK_VALIDATE=true;var JST_DEFAULT_DATE_MASK_VALIDATION_MESSAGE=&quot;&quot;;var JST_DEFAULT_DATE_MASK_YEAR_PAD_FUNCTION=getFullYear;var JST_DEFAULT_DATE_MASK_AM_PM_PAD_FUNCTION=function(value){if(isEmpty(value)) return &quot;&quot;;switch(left(value,1)){case &#x27;a&#x27;:return &#x27;am&#x27;;case &#x27;A&#x27;:return &#x27;AM&#x27;;case &#x27;p&#x27;:return &#x27;pm&#x27;;case &#x27;P&#x27;:return &#x27;PM&#x27;}
return value}
var JST_FIELD_DECIMAL_SEPARATOR=new Literal(typeof(JST_DEFAULT_DECIMAL_SEPARATOR)==&quot;undefined&quot;?&quot;,&quot;:JST_DEFAULT_DECIMAL_SEPARATOR);var JST_DEFAULT_LIMIT_OUTPUT_TEXT=&quot;${left}&quot;;numbers=new Input(JST_CHARS_NUMBERS);optionalNumbers=new Input(JST_CHARS_NUMBERS);optionalNumbers.optional=true;oneToTwoNumbers=new Input(JST_CHARS_NUMBERS,1,2);year=new Input(JST_CHARS_NUMBERS,1,4,getFullYear);dateSep=new Literal(&quot;/&quot;);dateTimeSep=new Literal(&quot; &quot;);timeSep=new Literal(&quot;:&quot;);
var JST_MASK_NUMBERS=[numbers];var JST_MASK_DECIMAL=[numbers,JST_FIELD_DECIMAL_SEPARATOR,optionalNumbers];var JST_MASK_UPPER=[new Upper(JST_CHARS_LETTERS)];var JST_MASK_LOWER=[new Lower(JST_CHARS_LETTERS)];var JST_MASK_CAPITALIZE=[new Capitalize(JST_CHARS_LETTERS)];var JST_MASK_LETTERS=[new Input(JST_CHARS_LETTERS)];var JST_MASK_ALPHA=[new Input(JST_CHARS_ALPHA)];var JST_MASK_ALPHA_UPPER=[new Upper(JST_CHARS_ALPHA)];var JST_MASK_ALPHA_LOWER=[new Lower(JST_CHARS_ALPHA)];var JST_MASK_DATE=[oneToTwoNumbers,dateSep,oneToTwoNumbers,dateSep,year];var JST_MASK_DATE_TIME=[oneToTwoNumbers,dateSep,oneToTwoNumbers,dateSep,year,dateTimeSep,oneToTwoNumbers,timeSep,oneToTwoNumbers];var JST_MASK_DATE_TIME_SEC=[oneToTwoNumbers,dateSep,oneToTwoNumbers,dateSep,year,dateTimeSep,oneToTwoNumbers,timeSep,oneToTwoNumbers,timeSep,oneToTwoNumbers];delete numbers;delete optionalNumbers;delete oneToTwoNumbers;delete year;delete dateSep;delete dateTimeSep;delete timeSep;
var JST_IGNORED_KEY_CODES=[45,35,36,33,34,37,39,38,40,127,4098];if(navigator.userAgent.toLowerCase().indexOf(&quot;khtml&quot;)&lt;0){JST_IGNORED_KEY_CODES[JST_IGNORED_KEY_CODES.length]=46}
for(var i=0;i&lt;32;i++){JST_IGNORED_KEY_CODES[JST_IGNORED_KEY_CODES.length]=i}
for(var i=112;i&lt;=123;i++){JST_IGNORED_KEY_CODES[JST_IGNORED_KEY_CODES.length]=i}
function InputMask(fields,control,keyPressFunction,keyDownFunction,keyUpFunction,blurFunction,updateFunction,changeFunction){if(isInstance(fields,String)){fields=maskBuilder.parse(fields)} else if(isInstance(fields,MaskField)){fields=[fields]}
if(isInstance(fields,Array)){for(var i=0;i&lt;fields.length;i++){var field=fields[i];if(!isInstance(field,MaskField)){alert(&quot;Invalid field: &quot;+field);return}}} else {alert(&quot;Invalid field array: &quot;+fields);return}
this.fields=fields;control=validateControlToMask(control);if(!control){alert(&quot;Invalid control to mask&quot;);return} else {this.control=control;prepareForCaret(this.control);this.control.supportsCaret=isCaretSupported(this.control)}
this.control.mask=this;this.control.pad=false;this.control.ignore=false;this.keyDownFunction=keyDownFunction||null;this.keyPressFunction=keyPressFunction||null;this.keyUpFunction=keyUpFunction||null;this.blurFunction=blurFunction||null;this.updateFunction=updateFunction||null;this.changeFunction=changeFunction||null;function onKeyDown(event){if(window.event){event=window.event}
this.keyCode=typedCode(event);if(this.mask.keyDownFunction!=null){var ret=invokeAsMethod(this,this.mask.keyDownFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}}
observeEvent(this.control,&quot;keydown&quot;,onKeyDown);function onKeyPress(event){if(window.event){event=window.event}
var keyCode=this.keyCode||typedCode(event);var ignore=event.altKey||event.ctrlKey||inArray(keyCode,JST_IGNORED_KEY_CODES);if(!ignore){var range=getInputSelectionRange(this);if(range!=null&amp;&amp;range[0]!=range[1]){replaceSelection(this,&quot;&quot;)}}
this.caretPosition=getCaret(this);this.setFixedLiteral=null;var typedChar=this.typedChar=ignore?&quot;&quot;:String.fromCharCode(typedCode(event));var fieldDescriptors=this.fieldDescriptors=this.mask.getCurrentFields();var currentFieldIndex=this.currentFieldIndex=this.mask.getFieldIndexUnderCaret();var accepted=false;if(!ignore){var currentField=this.mask.fields[currentFieldIndex];accepted=currentField.isAccepted(typedChar);if(accepted){if(currentField.upper){typedChar=this.typedChar=typedChar.toUpperCase()} else if(currentField.lower){typedChar=this.typedChar=typedChar.toLowerCase()}
if(currentFieldIndex==this.mask.fields.length-2){var nextFieldIndex=currentFieldIndex+1;var nextField=this.mask.fields[nextFieldIndex];if(nextField.literal){var currentFieldIsComplete=!currentField.acceptsMoreText(fieldDescriptors[currentFieldIndex].value+typedChar);if(currentFieldIsComplete){this.setFixedLiteral=nextFieldIndex}}}} else {var previousFieldIndex=currentFieldIndex-1;if(currentFieldIndex&gt;0&amp;&amp;this.mask.fields[previousFieldIndex].literal&amp;&amp;isEmpty(fieldDescriptors[previousFieldIndex].value)){this.setFixedLiteral=previousFieldIndex;accepted=true} else if(currentFieldIndex&lt;this.mask.fields.length-1){var descriptor=fieldDescriptors[currentFieldIndex];var nextFieldIndex=currentFieldIndex+1;var nextField=this.mask.fields[nextFieldIndex];if(nextField.literal&amp;&amp;nextField.text.indexOf(typedChar)&gt;=0){this.setFixedLiteral=nextFieldIndex;accepted=true}} else if(currentFieldIndex==this.mask.fields.length-1&amp;&amp;currentField.literal){this.setFixedLiteral=currentFieldIndex;accepted=true}}}
if(this.mask.keyPressFunction!=null){var ret=invokeAsMethod(this,this.mask.keyPressFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}
if(ignore){return}
var shouldApplyMask=!ignore&amp;&amp;accepted;if(shouldApplyMask){applyMask(this.mask,false)}
this.keyCode=null;return preventDefault(event)}
observeEvent(this.control,&quot;keypress&quot;,onKeyPress);function onKeyUp(event){if(window.event){event=window.event}
if(this.mask.keyUpFunction!=null){var ret=invokeAsMethod(this,this.mask.keyUpFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}}
observeEvent(this.control,&quot;keyup&quot;,onKeyUp);function onFocus(event){this._lastValue=this.value}
observeEvent(this.control,&quot;focus&quot;,onFocus);function onBlur(event){if(window.event){event=window.event}
document.fieldOnBlur=this;try {var valueChanged=this._lastValue!=this.value;if(valueChanged&amp;&amp;JST_MASK_VALIDATE_ON_BLUR){applyMask(this.mask,true)}
if(this.mask.changeFunction!=null){if(valueChanged&amp;&amp;this.mask.changeFunction!=null){var e={};for(property in event){e[property]=event[property]}
e.type=&quot;change&quot;;invokeAsMethod(this,this.mask.changeFunction,[e,this.mask])}}
if(this.mask.blurFunction!=null){var ret=invokeAsMethod(this,this.mask.blurFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}
return true} finally {document.fieldOnBlur=null}}
observeEvent(this.control,&quot;blur&quot;,onBlur);this.isComplete=function(){applyMask(this,true);var descriptors=this.getCurrentFields();if(descriptors==null||descriptors.length==0){return false}
for(var i=0;i&lt;this.fields.length;i++){var field=this.fields[i];if(field.input&amp;&amp;!field.isComplete(descriptors[i].value)&amp;&amp;!field.optional){return false}}
return true}
this.update=function(){applyMask(this,true)}
this.getCurrentFields=function(value){value=value||this.control.value;var descriptors=[];var currentIndex=0;var lastInputIndex=-1;for(var i=0;i&lt;this.fields.length;i++){var field=this.fields[i];var fieldValue=&quot;&quot;;var descriptor={};if(field.literal){if(lastInputIndex&gt;=0){var lastInputField=this.fields[lastInputIndex];var lastInputDescriptor=descriptors[lastInputIndex];if(field.text.indexOf(mid(value,currentIndex,1))&lt;0&amp;&amp;lastInputField.acceptsMoreText(lastInputDescriptor.value)){descriptor.begin=-1} else {descriptor.begin=currentIndex}}
if(currentIndex&gt;=value.length){break}
if(value.substring(currentIndex,currentIndex+field.text.length)==field.text){currentIndex+=field.text.length}} else {var upTo=field.upTo(value,currentIndex);if(upTo&lt;0&amp;&amp;currentIndex&gt;=value.length){break}
fieldValue=upTo&lt;0?&quot;&quot;:field.transformValue(value.substring(currentIndex,upTo+1));descriptor.begin=currentIndex;descriptor.value=fieldValue;currentIndex+=fieldValue.length;lastInputIndex=i}
descriptors[i]=descriptor}
var lastWithValue=descriptors.length-1;for(var i=0;i&lt;this.fields.length;i++){var field=this.fields[i];if(i&gt;lastWithValue){descriptors[i]={value:&quot;&quot;,begin:-1}} else {if(field.literal){var descriptor=descriptors[i];if(descriptor.begin&lt;0){descriptor.value=&quot;&quot;;continue}
var previousField=null;var previousValueComplete=false;for(var j=i-1;j&gt;=0;j--){var current=this.fields[j];if(current.input){previousField=current;previousValueComplete=current.isComplete(descriptors[j].value);if(previousValueComplete){break} else {previousField=null}}}
var nextField=null;var nextValueExists=null;for(var j=i+1;j&lt;this.fields.length&amp;&amp;j&lt;descriptors.length;j++){var current=this.fields[j];if(current.input){nextField=current;nextValueExists=!isEmpty(descriptors[j].value);if(nextValueExists){break} else {nextField=null}}}
if((previousValueComplete&amp;&amp;nextValueExists)||(previousField==null&amp;&amp;nextValueExists)||(nextField==null&amp;&amp;previousValueComplete)){descriptor.value=field.text} else {descriptor.value=&quot;&quot;;descriptor.begin=-1}}}}
return descriptors}
this.getFieldIndexUnderCaret=function(){var value=this.control.value;var caret=getCaret(this.control);if(caret==null) caret=value.length;var lastPosition=0;var lastInputIndex=null;var lastInputAcceptsMoreText=false;var lastWasLiteral=false;var returnNextInput=isEmpty(value)||caret==0;for(var i=0;i&lt;this.fields.length;i++){var field=this.fields[i];if(field.input){if(returnNextInput||lastPosition&gt;value.length){return i}
var upTo=field.upTo(value,lastPosition)
if(upTo&lt;0){return i}
if(field.max&lt;0){var nextField=null;if(i&lt;this.fields.length-1){nextField=this.fields[i+1]}
if(caret-1&lt;=upTo&amp;&amp;(nextField==null||nextField.literal)){return i}}
var fieldValue=value.substring(lastPosition,upTo+1);var acceptsMoreText=field.acceptsMoreText(fieldValue);var positionToCheck=acceptsMoreText?caret-1:caret
if(caret&gt;=lastPosition&amp;&amp;positionToCheck&lt;=upTo){return i}
lastInputAcceptsMoreText=acceptsMoreText;lastPosition=upTo+1;lastInputIndex=i} else {if(caret==lastPosition){returnNextInput=!lastInputAcceptsMoreText}
lastPosition+=field.text.length}
lastWasLiteral=field.literal}
return this.fields.length-1}
this.isOnlyFilter=function(){if(this.fields==null||this.fields.length==0){return true}
if(this.fields.length&gt;1){return false}
var field=this.fields[0];return field.input&amp;&amp;field.min&lt;=1&amp;&amp;field.max&lt;=0}
this.transformsCase=function(){if(this.fields==null||this.fields.length==0){return false}
for(var i=0;i&lt;this.fields.length;i++){var field=this.fields[i];if(field.upper||field.lower||field.capitalize){return true}}
return false}}
function NumberMask(parser,control,maxIntegerDigits,allowNegative,keyPressFunction,keyDownFunction,keyUpFunction,blurFunction,updateFunction,leftToRight,changeFunction){if(!isInstance(parser,NumberParser)){alert(&quot;Illegal NumberParser instance&quot;);return}
this.parser=parser;control=validateControlToMask(control);if(!control){alert(&quot;Invalid control to mask&quot;);return} else {this.control=control;prepareForCaret(this.control);this.control.supportsCaret=isCaretSupported(this.control)}
this.maxIntegerDigits=maxIntegerDigits||-1;this.allowNegative=allowNegative||JST_DEFAULT_ALLOW_NEGATIVE;this.leftToRight=leftToRight||JST_DEFAULT_LEFT_TO_RIGHT;this.control.mask=this;this.control.ignore=false;this.control.swapSign=false;this.control.toDecimal=false;this.control.oldValue=this.control.value;this.keyDownFunction=keyDownFunction||null;this.keyPressFunction=keyPressFunction||null;this.keyUpFunction=keyUpFunction||null;this.blurFunction=blurFunction||null;this.updateFunction=updateFunction||null;this.changeFunction=changeFunction||null;function onKeyDown(event){if(window.event){event=window.event}
var keyCode=typedCode(event);this.ignore=event.altKey||event.ctrlKey||inArray(keyCode,JST_IGNORED_KEY_CODES);if(this.mask.keyDownFunction!=null){var ret=invokeAsMethod(this,this.mask.keyDownFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}
return true}
observeEvent(this.control,&quot;keydown&quot;,onKeyDown);function onKeyPress(event){if(window.event){event=window.event}
var keyCode=typedCode(event);var typedChar=String.fromCharCode(keyCode);if(this.mask.keyPressFunction!=null){var ret=invokeAsMethod(this,this.mask.keyPressFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}
if(this.ignore){return true}
this.oldValue=this.value;if(typedChar==&#x27;-&#x27;){if(this.mask.allowNegative){if(this.value==&#x27;&#x27;){this.ignore=true;return true}
this.swapSign=true;applyNumberMask(this.mask,false,false)}
return preventDefault(event)}
if(this.mask.leftToRight&amp;&amp;typedChar==this.mask.parser.decimalSeparator&amp;&amp;this.mask.parser.decimalDigits!=0){this.toDecimal=true;if(this.supportsCaret){return preventDefault(event)}}
this.swapSign=false;this.toDecimal=false;this.accepted=false;if(this.mask.leftToRight&amp;&amp;typedChar==this.mask.parser.decimalSeparator){if(this.mask.parser.decimalDigits==0||this.value.indexOf(this.mask.parser.decimalSeparator)&gt;=0){this.accepted=true;return preventDefault(event)} else {return true}}
this.accepted=onlyNumbers(typedChar);if(!this.accepted){return preventDefault(event)}}
observeEvent(this.control,&quot;keypress&quot;,onKeyPress);function onKeyUp(event){if(this.mask.parser.decimalDigits&lt;0&amp;&amp;!this.mask.leftToRight){alert(&quot;A NumberParser with unlimited decimal digits is not supported on NumberMask when the leftToRight property is false&quot;);this.value=&quot;&quot;;return false}
if(window.event){event=window.event}
var keyCode=typedCode(event);var isBackSpace=(keyCode==8)&amp;&amp;JST_NUMBER_MASK_APPLY_ON_BACKSPACE;if(this.supportsCaret&amp;&amp;(this.toDecimal||(!this.ignore&amp;&amp;this.accepted)||isBackSpace)){if(isBackSpace&amp;&amp;this.mask.getAsNumber()==0){this.value=&quot;&quot;}
applyNumberMask(this.mask,false,isBackSpace)}
if(this.mask.keyUpFunction!=null){var ret=invokeAsMethod(this,this.mask.keyUpFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}
return true}
observeEvent(this.control,&quot;keyup&quot;,onKeyUp);function onFocus(event){if(this.mask.changeFunction!=null){this._lastValue=this.value}}
observeEvent(this.control,&quot;focus&quot;,onFocus);function onBlur(event){if(window.event){event=window.event}
if(JST_MASK_VALIDATE_ON_BLUR){if(this.value==&#x27;-&#x27;){this.value=&#x27;&#x27;} else {applyNumberMask(this.mask,true,false)}}
if(this.mask.changeFunction!=null){if(this._lastValue!=this.value&amp;&amp;this.mask.changeFunction!=null){var e={};for(property in event){e[property]=event[property]}
e.type=&quot;change&quot;;invokeAsMethod(this,this.mask.changeFunction,[e,this.mask])}}
if(this.mask.blurFunction!=null){var ret=invokeAsMethod(this,this.mask.blurFunction,[event,this.mask]);if(ret==false){return preventDefault(event)}}
return true}
observeEvent(this.control,&quot;blur&quot;,onBlur);this.isComplete=function(){return this.control.value!=&quot;&quot;}
this.getAsNumber=function(){var number=this.parser.parse(this.control.value);if(isNaN(number)){number=null}
return number}
this.setAsNumber=function(number){var value=&quot;&quot;;if(isInstance(number,Number)){value=this.parser.format(number)}
this.control.value=value;this.update()}
this.update=function(){applyNumberMask(this,true,false)}}
function DateMask(parser,control,validate,validationMessage,keyPressFunction,keyDownFunction,keyUpFunction,blurFunction,updateFunction,changeFunction){if(isInstance(parser,String)){parser=new DateParser(parser)}
if(!isInstance(parser,DateParser)){alert(&quot;Illegal DateParser instance&quot;);return}
this.parser=parser;this.extraKeyPressFunction=keyPressFunction||null;function maskKeyPressFunction(event,dateMask){dateMask.showValidation=true;if(dateMask.extraKeyPressFunction!=null){var ret=invokeAsMethod(this,dateMask.extraKeyPressFunction,[event,dateMask]);if(ret==false){return false}}
return true}
this.extraBlurFunction=blurFunction||null;function maskBlurFunction(event,dateMask){var control=dateMask.control;if(dateMask.validate&amp;&amp;control.value.length&gt;0){var controlValue=control.value.toUpperCase();controlValue=controlValue.replace(/A[^M]/,&quot;AM&quot;);controlValue=controlValue.replace(/A$/,&quot;AM&quot;);controlValue=controlValue.replace(/P[^M]/,&quot;PM&quot;);controlValue=controlValue.replace(/P$/,&quot;PM&quot;);var date=dateMask.parser.parse(controlValue);if(date==null){var msg=dateMask.validationMessage;if(dateMask.showValidation&amp;&amp;!isEmpty(msg)){dateMask.showValidation=false;msg=replaceAll(msg,&quot;${value}&quot;,control.value);msg=replaceAll(msg,&quot;${mask}&quot;,dateMask.parser.mask);alert(msg)}
control.value=&quot;&quot;;control.focus()} else {control.value=dateMask.parser.format(date)}}
if(dateMask.extraBlurFunction!=null){var ret=invokeAsMethod(this,dateMask.extraBlurFunction,[event,dateMask]);if(ret==false){return false}}
return true}
var fields=[];var old=&#x27;&#x27;;var mask=this.parser.mask;while(mask.length&gt;0){var field=mask.charAt(0);var size=1;var maxSize=-1;var padFunction=null;while(mask.charAt(size)==field){size++}
mask=mid(mask,size);var accepted=JST_CHARS_NUMBERS;switch(field){case &#x27;d&#x27;:case &#x27;M&#x27;:case &#x27;h&#x27;:case &#x27;H&#x27;:case &#x27;m&#x27;:case &#x27;s&#x27;:maxSize=2;break;case &#x27;y&#x27;:padFunction=JST_DEFAULT_DATE_MASK_YEAR_PAD_FUNCTION;if(size==2){maxSize=2} else {maxSize=4}
break;case &#x27;a&#x27;:case &#x27;A&#x27;:case &#x27;p&#x27;:case &#x27;P&#x27;:maxSize=2;padFunction=JST_DEFAULT_DATE_MASK_AM_PM_PAD_FUNCTION;accepted=&#x27;aApP&#x27;;break;case &#x27;S&#x27;:maxSize=3;break}
var input;if(maxSize==-1){input=new Literal(field)} else {input=new Input(accepted,size,maxSize);if(padFunction==null){input.padFunction=new Function(&quot;text&quot;,&quot;return lpad(text, &quot;+maxSize+&quot;, &#x27;0&#x27;)&quot;)} else {input.padFunction=padFunction}}
fields[fields.length]=input}
this.base=InputMask;this.base(fields,control,maskKeyPressFunction,keyDownFunction,keyUpFunction,maskBlurFunction,updateFunction,changeFunction);this.validate=validate==null?JST_DEFAULT_DATE_MASK_VALIDATE:booleanValue(validate);this.showValidation=true;this.validationMessage=validationMessage||JST_DEFAULT_DATE_MASK_VALIDATION_MESSAGE;this.control.dateMask=this;this.getAsDate=function(){return this.parser.parse(this.control.value)}
this.setAsDate=function(date){var value=&quot;&quot;;if(isInstance(date,Date)){value=this.parser.format(date)}
this.control.value=value;this.update()}}
function SizeLimit(control,maxLength,output,outputText,updateFunction,keyUpFunction,blurFunction,keyDownFunction,keyPressFunction,changeFunction){control=validateControlToMask(control);if(!control){alert(&quot;Invalid control to limit size&quot;);return} else {this.control=control;prepareForCaret(control)}
if(!isInstance(maxLength,Number)){alert(&quot;Invalid maxLength&quot;);return}
this.control=control;this.maxLength=maxLength;this.output=output||null;this.outputText=outputText||JST_DEFAULT_LIMIT_OUTPUT_TEXT;this.updateFunction=updateFunction||null;this.keyDownFunction=keyDownFunction||null;this.keyPressFunction=keyPressFunction||null;this.keyUpFunction=keyUpFunction||null;this.blurFunction=blurFunction||null;this.changeFunction=changeFunction||null;this.control.sizeLimit=this;function onKeyDown(event){if(window.event){event=window.event}
var keyCode=typedCode(event);this.ignore=inArray(keyCode,JST_IGNORED_KEY_CODES);if(this.sizeLimit.keyDownFunction!=null){var ret=invokeAsMethod(this,this.sizeLimit.keyDownFunction,[event,this.sizeLimit]);if(ret==false){return preventDefault(event)}}}
observeEvent(this.control,&quot;keydown&quot;,onKeyDown);function onKeyPress(event){if(window.event){event=window.event}
var keyCode=typedCode(event);var typedChar=String.fromCharCode(keyCode);var allowed=this.ignore||this.value.length&lt;this.sizeLimit.maxLength;if(this.sizeLimit.keyPressFunction!=null){var ret=invokeAsMethod(this,this.sizeLimit.keyPressFunction,[event,this.sizeLimit]);if(ret==false){return preventDefault(event)}}
if(!allowed){preventDefault(event)}}
observeEvent(this.control,&quot;keypress&quot;,onKeyPress);function onKeyUp(event){if(window.event){event=window.event}
if(this.sizeLimit.keyUpFunction!=null){var ret=invokeAsMethod(this,this.sizeLimit.keyUpFunction,[event,this.sizeLimit]);if(ret==false){return false}}
return checkSizeLimit(this,false)}
observeEvent(this.control,&quot;keyup&quot;,onKeyUp);function onFocus(event){if(this.mask&amp;&amp;this.mask.changeFunction!=null){this._lastValue=this.value}}
observeEvent(this.control,&quot;focus&quot;,onFocus);function onBlur(event){if(window.event){event=window.event}
var ret=checkSizeLimit(this,true);if(this.mask&amp;&amp;this.mask.changeFunction!=null){if(this._lastValue!=this.value&amp;&amp;this.sizeLimit.changeFunction!=null){var e={};for(property in event){e[property]=event[property]}
e.type=&quot;change&quot;;invokeAsMethod(this,this.sizeLimit.changeFunction,[e,this.sizeLimit])}}
if(this.sizeLimit.blurFunction!=null){var ret=invokeAsMethod(this,this.sizeLimit.blurFunction,[event,this.sizeLimit]);if(ret==false){return false}}
return ret}
observeEvent(this.control,&quot;blur&quot;,onBlur);this.update=function(){checkSizeLimit(this.control,true)}
this.update()}
function validateControlToMask(control){control=getObject(control)
if(control==null){return false} else if(!(control.type)||(!inArray(control.type,[&quot;text&quot;,&quot;textarea&quot;,&quot;password&quot;]))){return false} else {if(/MSIE/.test(navigator.userAgent)&amp;&amp;!window.opera){observeEvent(self,&quot;unload&quot;,function(){control.mask=control.dateMask=control.sizeLimit=null})}
return control}}
function applyMask(mask,isBlur){var fields=mask.fields;if((fields==null)||(fields.length==0)){return}
var control=mask.control;if(isEmpty(control.value)&amp;&amp;isBlur){return true}
var value=control.value;var typedChar=control.typedChar;var typedIndex=control.caretPosition;var setFixedLiteral=control.setFixedLiteral;var currentFieldIndex=mask.getFieldIndexUnderCaret();var fieldDescriptors=mask.getCurrentFields();var currentDescriptor=fieldDescriptors[currentFieldIndex];if(isBlur||!isEmpty(typedChar)){var out=new StringBuffer(fields.length);var caretIncrement=1;for(var i=0;i&lt;fields.length;i++){var field=fields[i];var descriptor=fieldDescriptors[i];var padValue=(setFixedLiteral==i+1);if(currentFieldIndex==i+1&amp;&amp;field.literal&amp;&amp;typedIndex==descriptor.begin){caretIncrement+=field.text.length} else if(field.literal&amp;&amp;currentFieldIndex&gt;i){descriptor.value=field.text;caretIncrement+=field.text.length+1} else if(currentFieldIndex==i){if(!isEmpty(typedIndex)&amp;&amp;!isEmpty(typedChar)&amp;&amp;field.isAccepted(typedChar)){var fieldStartsAt=descriptor.begin&lt;0?value.length:descriptor.begin;var insertAt=Math.max(0,typedIndex-fieldStartsAt);if(field.input&amp;&amp;field.acceptsMoreText(descriptor.value)){descriptor.value=insertString(descriptor.value,insertAt,typedChar)} else {var prefix=left(descriptor.value,insertAt);var suffix=mid(descriptor.value,insertAt+1);descriptor.value=prefix+typedChar+suffix}}}
if(isBlur&amp;&amp;!isEmpty(descriptor.value)&amp;&amp;i==fields.length-1&amp;&amp;field.input){padValue=true
}
if(padValue){var oldValue=descriptor.value;descriptor.value=field.pad(descriptor.value);var inc=descriptor.value.length-oldValue.length;if(inc&gt;0){caretIncrement+=inc}}
out.append(descriptor.value)}
value=out.toString()}
fieldDescriptors=mask.getCurrentFields(value);var out=new StringBuffer(fields.length);for(var i=0;i&lt;fields.length;i++){var field=fields[i];var descriptor=fieldDescriptors[i];if(field.literal&amp;&amp;(setFixedLiteral==i||(i&lt;fields.length-1&amp;&amp;!isEmpty(fieldDescriptors[i+1].value)))){descriptor.value=field.text}
out.append(descriptor.value)}
control.value=out.toString();if(control.caretPosition!=null&amp;&amp;!isBlur){if(control.pad){setCaretToEnd(control)} else {setCaret(control,typedIndex+control.value.length-value.length+caretIncrement)}}
if(mask.updateFunction!=null){mask.updateFunction(mask)}
control.typedChar=null;control.fieldDescriptors=null;control.currentFieldIndex=null;return false}
function nonDigitsToCaret(value,caret){if(caret==null){return null}
var nonDigits=0;for(var i=0;i&lt;caret&amp;&amp;i&lt;value.length;i++){if(!onlyNumbers(value.charAt(i))){nonDigits++}}
return nonDigits}
function applyNumberMask(numberMask,isBlur,isBackSpace){var control=numberMask.control;var value=control.value;if(value==&quot;&quot;){return true}
var parser=numberMask.parser;var maxIntegerDigits=numberMask.maxIntegerDigits;var swapSign=false;var toDecimal=false;var leftToRight=numberMask.leftToRight;if(control.swapSign==true){swapSign=true;control.swapSign=false}
if(control.toDecimal==true){toDecimal=value.indexOf(parser.decimalSeparator)&lt;0;control.toDecimal=false}
var intPart=&quot;&quot;;var decPart=&quot;&quot;;var isNegative=value.indexOf(&#x27;-&#x27;)&gt;=0||value.indexOf(&#x27;(&#x27;)&gt;=0;if(value==&quot;&quot;){value=parser.format(0)}
value=replaceAll(value,parser.groupSeparator,&#x27;&#x27;)
value=replaceAll(value,parser.currencySymbol,&#x27;&#x27;)
value=replaceAll(value,&#x27;-&#x27;,&#x27;&#x27;)
value=replaceAll(value,&#x27;(&#x27;,&#x27;&#x27;)
value=replaceAll(value,&#x27;)&#x27;,&#x27;&#x27;)
value=replaceAll(value,&#x27; &#x27;,&#x27;&#x27;)
var pos=value.indexOf(parser.decimalSeparator);var hasDecimal=(pos&gt;=0);var caretAdjust=0;if(leftToRight){if(hasDecimal){intPart=value.substr(0,pos);decPart=value.substr(pos+1)} else {intPart=value}
if(isBlur&amp;&amp;parser.decimalDigits&gt;0){decPart=rpad(decPart,parser.decimalDigits,&#x27;0&#x27;)}} else {var decimalDigits=parser.decimalDigits;value=replaceAll(value,parser.decimalSeparator,&#x27;&#x27;);intPart=left(value,value.length-decimalDigits);decPart=lpad(right(value,decimalDigits),decimalDigits,&#x27;0&#x27;)}
var zero=onlySpecified(intPart+decPart,&#x27;0&#x27;);if((!isEmpty(intPart)&amp;&amp;!onlyNumbers(intPart))||(!isEmpty(decPart)&amp;&amp;!onlyNumbers(decPart))){control.value=control.oldValue;return true}
if(leftToRight&amp;&amp;parser.decimalDigits&gt;=0&amp;&amp;decPart.length&gt;parser.decimalDigits){decPart=decPart.substring(0,parser.decimalDigits)}
if(maxIntegerDigits&gt;=0&amp;&amp;intPart.length&gt;maxIntegerDigits){caretAdjust=maxIntegerDigits-intPart.length-1;intPart=left(intPart,maxIntegerDigits)}
if(zero){isNegative=false} else if(swapSign){isNegative=!isNegative}
if(!isEmpty(intPart)){while(intPart.charAt(0)==&#x27;0&#x27;){intPart=intPart.substr(1)}}
if(isEmpty(intPart)){intPart=&quot;0&quot;}
if((parser.useGrouping)&amp;&amp;(!isEmpty(parser.groupSeparator))){var group,temp=&quot;&quot;;for(var i=intPart.length;i&gt;0;i-=parser.groupSize){group=intPart.substring(intPart.length-parser.groupSize);intPart=intPart.substring(0,intPart.length-parser.groupSize);temp=group+parser.groupSeparator+temp}
intPart=temp.substring(0,temp.length-1)}
var out=new StringBuffer();var oneFormatted=parser.format(isNegative?-1:1);var appendEnd=true;pos=oneFormatted.indexOf(&#x27;1&#x27;);out.append(oneFormatted.substring(0,pos));out.append(intPart);if(leftToRight){if(toDecimal||!isEmpty(decPart)){out.append(parser.decimalSeparator).append(decPart);appendEnd=!toDecimal}} else {if(parser.decimalDigits&gt;0){out.append(parser.decimalSeparator)}
out.append(decPart)}
if(appendEnd&amp;&amp;oneFormatted.indexOf(&quot;)&quot;)&gt;=0){out.append(&quot;)&quot;)}
var caret=getCaret(control);var oldNonDigitsToCaret=nonDigitsToCaret(control.value,caret),hadSymbol;var caretToEnd=toDecimal||caret==null||caret==control.value.length;if(caret!=null&amp;&amp;!isBlur){hadSymbol=control.value.indexOf(parser.currencySymbol)&gt;=0||control.value.indexOf(parser.decimalSeparator)&gt;=0}
control.value=out.toString();if(caret!=null&amp;&amp;!isBlur){if(!hadSymbol&amp;&amp;((value.indexOf(parser.currencySymbol)&gt;=0)||(value.indexOf(parser.decimalSeparator)&gt;=0))){caretToEnd=true}
if(!caretToEnd){var newNonDigitsToCaret=nonDigitsToCaret(control.value,caret);if(isBackSpace){caretAdjust=0}
setCaret(control,caret+caretAdjust+newNonDigitsToCaret-oldNonDigitsToCaret)} else {setCaretToEnd(control)}}
if(numberMask.updateFunction!=null){numberMask.updateFunction(numberMask)}
return false}
function checkSizeLimit(control,isBlur){var sizeLimit=control.sizeLimit;var max=sizeLimit.maxLength;var diff=max-control.value.length;if(control.value.length&gt;max){control.value=left(control.value,max);setCaretToEnd(control)}
var size=control.value.length;var charsLeft=max-size;if(sizeLimit.output!=null){var text=sizeLimit.outputText;text=replaceAll(text,&quot;${size}&quot;,size);text=replaceAll(text,&quot;${left}&quot;,charsLeft);text=replaceAll(text,&quot;${max}&quot;,max);setValue(sizeLimit.output,text)}
if(isInstance(sizeLimit.updateFunction,Function)){sizeLimit.updateFunction(control,size,max,charsLeft)}
return true}
function MaskField(){this.literal=false;this.input=false;this.upTo=function(text,fromIndex){return-1}}
function Literal(text){this.base=MaskField;this.base();this.text=text;this.literal=true;this.isAccepted=function(chr){return onlySpecified(chr,this.text)}
this.upTo=function(text,fromIndex){return text.indexOf(this.text,fromIndex)}}
function Input(accepted,min,max,padFunction,optional){this.base=MaskField;this.base();this.accepted=accepted;if(min!=null&amp;&amp;max==null){max=min}
this.min=min||1;this.max=max||-1;this.padFunction=padFunction||null;this.input=true;this.upper=false;this.lower=false;this.capitalize=false;this.optional=booleanValue(optional);if(this.min&lt;1){this.min=1}
if(this.max==0){this.max=-1}
if((this.max&lt;this.min)&amp;&amp;(this.max&gt;=0)){this.max=this.min}
this.upTo=function(text,fromIndex){text=text||&quot;&quot;;fromIndex=fromIndex||0;if(text.length&lt;fromIndex){return-1}
var toIndex=-1;for(var i=fromIndex;i&lt;text.length;i++){if(this.isAccepted(text.substring(fromIndex,i+1))){toIndex=i} else {break}}
return toIndex}
this.acceptsMoreText=function(text){if(this.max&lt;0) return true;return(text||&quot;&quot;).length&lt;this.max}
this.isAccepted=function(text){return((this.accepted==null)||onlySpecified(text,this.accepted))&amp;&amp;((text.length&lt;=this.max)||(this.max&lt;0))}
this.checkLength=function(text){return(text.length&gt;=this.min)&amp;&amp;((this.max&lt;0)||(text.length&lt;=this.max))}
this.isComplete=function(text){text=String(text);if(isEmpty(text)){return this.optional}
return text.length&gt;=this.min}
this.transformValue=function(text){text=String(text);if(this.upper){return text.toUpperCase()} else if(this.lower){return text.toLowerCase()} else if(this.capitalize){return capitalize(text)} else {return text}}
this.pad=function(text){text=String(text);if((text.length&lt;this.min)&amp;&amp;((this.max&gt;=0)||(text.length&lt;=this.max))||this.max&lt;0){var value;if(this.padFunction!=null){value=this.padFunction(text,this.min,this.max)} else {value=text}
if(value.length&lt;this.min){var padChar=&#x27; &#x27;;if(this.accepted==null||this.accepted.indexOf(&#x27; &#x27;)&gt;0){padChar=&#x27; &#x27;} else if(this.accepted.indexOf(&#x27;0&#x27;)&gt;0){padChar=&#x27;0&#x27;} else {padChar=this.accepted.charAt(0)}
return left(lpad(value,this.min,padChar),this.min)} else {return value}} else {return text}}}
function Lower(accepted,min,max,padFunction,optional){this.base=Input;this.base(accepted,min,max,padFunction,optional);this.lower=true}
function Upper(accepted,min,max,padFunction,optional){this.base=Input;this.base(accepted,min,max,padFunction,optional);this.upper=true}
function Capitalize(accepted,min,max,padFunction,optional){this.base=Input;this.base(accepted,min,max,padFunction,optional);this.capitalize=true}
function FieldBuilder(){
this.literal=function(text){return new Literal(text)}
this.input=function(accepted,min,max,padFunction,optional){return new Input(accepted,min,max,padFunction,optional)}
this.upper=function(accepted,min,max,padFunction,optional){return new Upper(accepted,min,max,padFunction,optional)}
this.lower=function(accepted,min,max,padFunction,optional){return new Lower(accepted,min,max,padFunction,optional)}
this.capitalize=function(accepted,min,max,padFunction,optional){return new Capitalize(accepted,min,max,padFunction,optional)}
this.inputAll=function(min,max,padFunction,optional){return this.input(null,min,max,padFunction,optional)}
this.upperAll=function(min,max,padFunction,optional){return this.upper(null,min,max,padFunction,optional)}
this.lowerAll=function(min,max,padFunction,optional){return this.lower(null,min,max,padFunction,optional)}
this.capitalizeAll=function(min,max,padFunction,optional){return this.capitalize(null,min,max,padFunction,optional)}
this.inputNumbers=function(min,max,padFunction,optional){return this.input(JST_CHARS_NUMBERS,min,max,padFunction,optional)}
this.inputLetters=function(min,max,padFunction,optional){return this.input(JST_CHARS_LETTERS,min,max,padFunction,optional)}
this.upperLetters=function(min,max,padFunction,optional){return this.upper(JST_CHARS_LETTERS,min,max,padFunction,optional)}
this.lowerLetters=function(min,max,padFunction,optional){return this.lower(JST_CHARS_LETTERS,min,max,padFunction,optional)}
this.capitalizeLetters=function(min,max,padFunction,optional){return this.capitalize(JST_CHARS_LETTERS,min,max,padFunction,optional)}}
var fieldBuilder=new FieldBuilder();
function MaskBuilder(){
this.parse=function(string){if(string==null||!isInstance(string,String)){return this.any()}
var fields=[];var start=null;var lastType=null;var switchField=function(type,text){switch(type){case &#x27;_&#x27;:return fieldBuilder.inputAll(text.length);case &#x27;#&#x27;:return fieldBuilder.inputNumbers(text.length);case &#x27;a&#x27;:return fieldBuilder.inputLetters(text.length);case &#x27;l&#x27;:return fieldBuilder.lowerLetters(text.length);case &#x27;u&#x27;:return fieldBuilder.upperLetters(text.length);case &#x27;c&#x27;:return fieldBuilder.capitalizeLetters(text.length);default:return fieldBuilder.literal(text)}}
for(var i=0;i&lt;string.length;i++){var c=string.charAt(i);if(start==null){start=i}
var type;var literal=false;if(c==&#x27;\\&#x27;){if(i==string.length-1){break}
string=left(string,i)+mid(string,i+1);c=string.charAt(i);literal=true}
if(literal){type=&#x27;?&#x27;} else {switch(c){case &#x27;?&#x27;:case &#x27;_&#x27;:type=&#x27;_&#x27;;break;case &#x27;#&#x27;:case &#x27;0&#x27;:case &#x27;9&#x27;:type=&#x27;#&#x27;;break;case &#x27;a&#x27;:case &#x27;A&#x27;:type=&#x27;a&#x27;;break;case &#x27;l&#x27;:case &#x27;L&#x27;:type=&#x27;l&#x27;;break;case &#x27;u&#x27;:case &#x27;U&#x27;:type=&#x27;u&#x27;;break;case &#x27;c&#x27;:case &#x27;C&#x27;:type=&#x27;c&#x27;;break;default:type=&#x27;?&#x27;}}
if(lastType!=type&amp;&amp;lastType!=null){var text=string.substring(start,i);fields[fields.length]=switchField(lastType,text);start=i;lastType=type} else {lastType=type
}}
if(start&lt;string.length){var text=string.substring(start);fields[fields.length]=switchField(lastType,text)}
return fields}
this.accept=function(accepted,max){return [fieldBuilder.input(accepted,max)]}
this.any=function(max){return [fieldBuilder.any(max)]}
this.numbers=function(max){return [fieldBuilder.inputNumbers(max)]}
this.decimal=function(){var decimalField=fieldBuilder.inputNumbers();decimalField.optional=true;return [fieldBuilder.inputNumbers(),JST_FIELD_DECIMAL_SEPARATOR,decimalField]}
this.letters=function(max){return [fieldBuilder.inputLetters(max)]}
this.upperLetters=function(max){return [fieldBuilder.upperLetters(max)]}
this.lowerLetters=function(max){return [fieldBuilder.lowerLetters(max)]}
this.capitalizeLetters=function(max){return [fieldBuilder.capitalizeLetters(max)]}}
var maskBuilder=new MaskBuilder();
/*
 * Parsers is a part of JavaScripTools (http://javascriptools.sourceforge.net).
 * This file was compressed using JavaScriptZip (http://javascriptzip.sourceforge.net).
 * Author: Luis Fernando Planella Gonzalez (lfpg.dev at gmail dot com)
 * Version: 2.2.5
 * JavaScripTools is distributed under the GNU Lesser General Public License (LGPL).
 * For more information, see http://www.gnu.org/licenses/lgpl-2.1.txt
*/
var JST_DEFAULT_DECIMAL_DIGITS=-1;var JST_DEFAULT_DECIMAL_SEPARATOR=&quot;,&quot;;var JST_DEFAULT_GROUP_SEPARATOR=&quot;.&quot;;var JST_DEFAULT_USE_GROUPING=false;var JST_DEFAULT_CURRENCY_SYMBOL=&quot;R$&quot;;var JST_DEFAULT_USE_CURRENCY=false;var JST_DEFAULT_NEGATIVE_PARENTHESIS=false;var JST_DEFAULT_GROUP_SIZE=3;var JST_DEFAULT_SPACE_AFTER_CURRENCY=true;var JST_DEFAULT_CURRENCY_INSIDE=false;var JST_DEFAULT_DATE_MASK=&quot;dd/MM/yyyy&quot;;var JST_DEFAULT_ENFORCE_LENGTH=true;var JST_DEFAULT_TRUE_VALUE=&quot;true&quot;;var JST_DEFAULT_FALSE_VALUE=&quot;false&quot;;var JST_DEFAULT_USE_BOOLEAN_VALUE=true;
function Parser(){
this.parse=function(text){return text}
this.format=function(value){return value}
this.isValid=function(text){return isEmpty(text)||(this.parse(text)!=null)}}
function NumberParser(decimalDigits,decimalSeparator,groupSeparator,useGrouping,currencySymbol,useCurrency,negativeParenthesis,groupSize,spaceAfterCurrency,currencyInside){this.base=Parser;this.base();this.decimalDigits=(decimalDigits==null)?JST_DEFAULT_DECIMAL_DIGITS:decimalDigits;this.decimalSeparator=(decimalSeparator==null)?JST_DEFAULT_DECIMAL_SEPARATOR:decimalSeparator;this.groupSeparator=(groupSeparator==null)?JST_DEFAULT_GROUP_SEPARATOR:groupSeparator;this.useGrouping=(useGrouping==null)?JST_DEFAULT_USE_GROUPING:booleanValue(useGrouping);this.currencySymbol=(currencySymbol==null)?JST_DEFAULT_CURRENCY_SYMBOL:currencySymbol;this.useCurrency=(useCurrency==null)?JST_DEFAULT_USE_CURRENCY:booleanValue(useCurrency);this.negativeParenthesis=(negativeParenthesis==null)?JST_DEFAULT_NEGATIVE_PARENTHESIS:booleanValue(negativeParenthesis);this.groupSize=(groupSize==null)?JST_DEFAULT_GROUP_SIZE:groupSize;this.spaceAfterCurrency=(spaceAfterCurrency==null)?JST_DEFAULT_SPACE_AFTER_CURRENCY:booleanValue(spaceAfterCurrency);this.currencyInside=(currencyInside==null)?JST_DEFAULT_CURRENCY_INSIDE:booleanValue(currencyInside);this.parse=function(string){string=trim(string);if(isEmpty(string)){return null}
string=replaceAll(string,this.groupSeparator,&quot;&quot;);string=replaceAll(string,this.decimalSeparator,&quot;.&quot;);string=replaceAll(string,this.currencySymbol,&quot;&quot;);var isNegative=(string.indexOf(&quot;(&quot;)&gt;=0)||(string.indexOf(&quot;-&quot;)&gt;=0);string=replaceAll(string,&quot;(&quot;,&quot;&quot;);string=replaceAll(string,&quot;)&quot;,&quot;&quot;);string=replaceAll(string,&quot;-&quot;,&quot;&quot;);string=trim(string);if(!onlySpecified(string,JST_CHARS_NUMBERS+&quot;.&quot;)){return null}
var ret=parseFloat(string);ret=isNegative?(ret*-1):ret;return this.round(ret)}
this.format=function(number){if(isNaN(number)){number=this.parse(number)}
if(isNaN(number)) return null;var isNegative=number&lt;0;number=Math.abs(number);var ret=&quot;&quot;;var parts=String(this.round(number)).split(&quot;.&quot;);var intPart=parts[0];var decPart=parts.length&gt;1?parts[1]:&quot;&quot;;if((this.useGrouping)&amp;&amp;(!isEmpty(this.groupSeparator))){var group,temp=&quot;&quot;;for(var i=intPart.length;i&gt;0;i-=this.groupSize){group=intPart.substring(intPart.length-this.groupSize);intPart=intPart.substring(0,intPart.length-this.groupSize);temp=group+this.groupSeparator+temp}
intPart=temp.substring(0,temp.length-1)}
ret=intPart;if(this.decimalDigits!=0){if(this.decimalDigits&gt;0){while(decPart.length&lt;this.decimalDigits){decPart+=&quot;0&quot;}}
if(!isEmpty(decPart)){ret+=this.decimalSeparator+decPart}}
if(isNegative&amp;&amp;!this.currencyInside){if(this.negativeParenthesis){ret=&quot;(&quot;+ret+&quot;)&quot;} else {ret=&quot;-&quot;+ret}}
if(this.useCurrency){ret=this.currencySymbol+(this.spaceAfterCurrency?&quot; &quot;:&quot;&quot;)+ret}
if(isNegative&amp;&amp;this.currencyInside){if(this.negativeParenthesis){ret=&quot;(&quot;+ret+&quot;)&quot;} else {ret=&quot;-&quot;+ret}}
return ret}
this.round=function(number){if(this.decimalDigits&lt;0){return number} else if(this.decimalDigits==0){return Math.round(number)}
var mult=Math.pow(10,this.decimalDigits);return Math.round(number*mult)/mult}}
function DateParser(mask,enforceLength,completeFieldsWith){this.base=Parser;this.base();this.mask=(mask==null)?JST_DEFAULT_DATE_MASK:String(mask);this.enforceLength=(enforceLength==null)?JST_DEFAULT_ENFORCE_LENGTH:booleanValue(enforceLength);this.completeFieldsWith=completeFieldsWith||null;this.numberParser=new NumberParser(0);this.compiledMask=[];var LITERAL=0;var MILLISECOND=1;var SECOND=2;var MINUTE=3;var HOUR_12=4;var HOUR_24=5;var DAY=6;var MONTH=7;var YEAR=8;var AM_PM_UPPER=9;var AM_PM_LOWER=10;this.parse=function(string){if(isEmpty(string)){return null}
string=trim(String(string)).toUpperCase();var pm=string.indexOf(&quot;PM&quot;)!=-1;string=replaceAll(replaceAll(string,&quot;AM&quot;,&quot;&quot;),&quot;PM&quot;,&quot;&quot;);var parts=[0,0,0,0,0,0,0];var partValues=[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;];var entries=[null,null,null,null,null,null,null];for(var i=0;i&lt;this.compiledMask.length;i++){var entry=this.compiledMask[i];var pos=this.getTypeIndex(entry.type);if(pos==-1){if(entry.type==LITERAL){string=string.substr(entry.length)} else {}} else {var partValue=0;if(i==(this.compiledMask.length-1)){partValue=string;string=&quot;&quot;} else {var nextEntry=this.compiledMask[i+1];if(nextEntry.type==LITERAL){var nextPos=string.indexOf(nextEntry.literal);if(nextPos==-1){partValue=string
string=&quot;&quot;} else {partValue=left(string,nextPos);string=string.substr(nextPos)}} else {partValue=string.substring(0,entry.length);string=string.substr(entry.length)}}
if(!onlyNumbers(partValue)){return null}
partValues[pos]=partValue;entries[pos]=entry;parts[pos]=isEmpty(partValue)?this.minValue(parts,entry.type):this.numberParser.parse(partValue)}}
if(!isEmpty(string)){return null}
if(pm&amp;&amp;(parts[JST_FIELD_HOUR]&lt;12)){parts[JST_FIELD_HOUR]+=12}
if(parts[JST_FIELD_MONTH]&gt;0){parts[JST_FIELD_MONTH]--}
if(parts[JST_FIELD_YEAR]&lt;100){if(parts[JST_FIELD_YEAR]&lt;50){parts[JST_FIELD_YEAR]+=2000} else {parts[JST_FIELD_YEAR]+=1900}}
for(var i=0;i&lt;parts.length;i++){var entry=entries[i]
var part=parts[i];var partValue=partValues[i];if(part&lt;0){return null} else if(entry!=null){if(this.enforceLength&amp;&amp;((entry.length&gt;=0)&amp;&amp;(partValue.length&lt;entry.length))){return null}
part=parseInt(partValue,10);if(isNaN(part)&amp;&amp;this.completeFieldsWith!=null){part=parts[i]=getDateField(this.completeFieldsWith,i)}
if((part&lt;this.minValue(parts,entry.type))||(part&gt;this.maxValue(parts,entry.type))){return null}} else if(i==JST_FIELD_DAY&amp;&amp;part==0){part=parts[i]=1}}
return new Date(parts[JST_FIELD_YEAR],parts[JST_FIELD_MONTH],parts[JST_FIELD_DAY],parts[JST_FIELD_HOUR],parts[JST_FIELD_MINUTE],parts[JST_FIELD_SECOND],parts[JST_FIELD_MILLISECOND])}
this.format=function(date){if(!(date instanceof Date)){date=this.parse(date)}
if(date==null){return &quot;&quot;}
var ret=&quot;&quot;;var parts=[date.getMilliseconds(),date.getSeconds(),date.getMinutes(),date.getHours(),date.getDate(),date.getMonth(),date.getFullYear()];for(var i=0;i&lt;this.compiledMask.length;i++){var entry=this.compiledMask[i];switch(entry.type){case LITERAL:ret+=entry.literal;break;case AM_PM_LOWER:ret+=(parts[JST_FIELD_HOUR]&lt;12)?&quot;am&quot;:&quot;pm&quot;;break;case AM_PM_UPPER:ret+=(parts[JST_FIELD_HOUR]&lt;12)?&quot;AM&quot;:&quot;PM&quot;;break;case MILLISECOND:case SECOND:case MINUTE:case HOUR_24:case DAY:ret+=lpad(parts[this.getTypeIndex(entry.type)],entry.length,&quot;0&quot;);break;case HOUR_12:ret+=lpad(parts[JST_FIELD_HOUR]%12,entry.length,&quot;0&quot;);break;case MONTH:ret+=lpad(parts[JST_FIELD_MONTH]+1,entry.length,&quot;0&quot;);break;case YEAR:ret+=lpad(right(parts[JST_FIELD_YEAR],entry.length),entry.length,&quot;0&quot;);break}}
return ret}
this.maxValue=function(parts,type){switch(type){case MILLISECOND:return 999;case SECOND:return 59;case MINUTE:return 59;case HOUR_12:case HOUR_24:return 23;case DAY:return getMaxDay(parts[JST_FIELD_MONTH],parts[JST_FIELD_YEAR]);case MONTH:return 12;case YEAR:return 9999;default:return 0}}
this.minValue=function(parts,type){switch(type){case DAY:case MONTH:case YEAR:return 1;default:return 0}}
this.getFieldType=function(field){switch(field.charAt(0)){case &quot;S&quot;:return MILLISECOND;case &quot;s&quot;:return SECOND;case &quot;m&quot;:return MINUTE;case &quot;h&quot;:return HOUR_12;case &quot;H&quot;:return HOUR_24;case &quot;d&quot;:return DAY;case &quot;M&quot;:return MONTH;case &quot;y&quot;:return YEAR;case &quot;a&quot;:return AM_PM_LOWER;case &quot;A&quot;:return AM_PM_UPPER;default:return LITERAL}}
this.getTypeIndex=function(type){switch(type){case MILLISECOND:return JST_FIELD_MILLISECOND;case SECOND:return JST_FIELD_SECOND;case MINUTE:return JST_FIELD_MINUTE;case HOUR_12:case HOUR_24:return JST_FIELD_HOUR;case DAY:return JST_FIELD_DAY;case MONTH:return JST_FIELD_MONTH;case YEAR:return JST_FIELD_YEAR;default:return-1}}
var Entry=function(type,length,literal){this.type=type;this.length=length||-1;this.literal=literal}
this.compile=function(){var current=&quot;&quot;;var old=&quot;&quot;;var part=&quot;&quot;;this.compiledMask=[];for(var i=0;i&lt;this.mask.length;i++){current=this.mask.charAt(i);if((part==&quot;&quot;)||(current==part.charAt(0))){part+=current} else {var type=this.getFieldType(part);this.compiledMask[this.compiledMask.length]=new Entry(type,part.length,part);part=&quot;&quot;;i--}}
if(part!=&quot;&quot;){var type=this.getFieldType(part);this.compiledMask[this.compiledMask.length]=new Entry(type,part.length,part)}}
this.setMask=function(mask){this.mask=mask;this.compile()}
this.setMask(this.mask)}
function BooleanParser(trueValue,falseValue,useBooleanValue){this.base=Parser;this.base();this.trueValue=trueValue||JST_DEFAULT_TRUE_VALUE;this.falseValue=falseValue||JST_DEFAULT_FALSE_VALUE;this.useBooleanValue=useBooleanValue||JST_DEFAULT_USE_BOOLEAN_VALUE;this.parse=function(string){if(this.useBooleanValue&amp;&amp;booleanValue(string)){return true}
return string==JST_DEFAULT_TRUE_VALUE}
this.format=function(bool){return booleanValue(bool)?this.trueValue:this.falseValue}}
function StringParser(){this.base=Parser;this.base();this.parse=function(string){return String(string)}
this.format=function(string){return String(string)}}
function MapParser(map,directParse){this.base=Parser;this.base();this.map=isInstance(map,Map)?map:new Map();this.directParse=booleanValue(directParse);this.parse=function(value){if(directParse){return value}
var pairs=this.map.getPairs();for(var k=0;k&lt;pairs.length;k++){if(value==pairs[k].value){return pairs[k].key}}
return null}
this.format=function(value){return this.map.get(value)}}
function EscapeParser(extraChars,onlyExtra){this.base=Parser;this.base();this.extraChars=extraChars||&quot;&quot;;this.onlyExtra=booleanValue(onlyExtra);this.parse=function(value){if(value==null){return null}
return unescapeCharacters(String(value),extraChars,onlyExtra)}
this.format=function(value){if(value==null){return null}
return escapeCharacters(String(value),onlyExtra)}}
function CustomParser(formatFunction,parseFunction){this.base=Parser;this.base();this.formatFunction=formatFunction||function(value){return value};this.parseFunction=parseFunction||function(value){return value};this.parse=function(value){return parseFunction.apply(this,arguments)}
this.format=function(value){return formatFunction.apply(this,arguments)}}
function WrapperParser(wrappedParser,formatFunction,parseFunction){this.base=Parser;this.base();this.wrappedParser=wrappedParser||new CustomParser();this.formatFunction=formatFunction||function(value){return value};this.parseFunction=parseFunction||function(value){return value};this.format=function(value){var formatted=this.wrappedParser.format.apply(this.wrappedParser,arguments);var args=[];args[0]=formatted;args[1]=arguments[0];for(var i=1,len=arguments.length;i&lt;len;i++){args[i+1]=arguments[i]}
return formatFunction.apply(this,args)}
this.parse=function(value){var parsed=parseFunction.apply(this,arguments);arguments[0]=parsed;return this.wrappedParser.parse.apply(this.wrappedParser,arguments)}}
var bardia = {
	INVISIBLE: 0,
	READONLY: 1,
	VISIBLE: 2
};
bardia.oop = {
}
bardia.oop.Class = (function() {

    function create(body) {

        function klass(config) {
            this.initialize(config); 
        }

        for (fun in body) {
            klass.prototype[fun] = body[fun];
        }

        return klass;
    }

    function extend(target, source) {
        for (var prop in source) {
            target[prop] = source[prop];
        }

        return target;
    }

    function inherit(_function, body) {
        var klass = function(config) {
            this.initialize(config); 
        }

    	var fun = null;
    	for (fun in _function.prototype) {
    		klass.prototype[fun] = _function.prototype[fun];
    	}
    	
        for (fun in body) {
            klass.prototype[fun] = body[fun];
        }

    	return klass;
    }

    return {
        create: create,
        extend: extend,
        inherit: inherit
    };
    
})();
/**
 *
 */
bardia.dom = {

};

/**
 * creates an element
 */
$_element = (function() {
    function create(jsonRoot) {
        return new bardia.dom.Element(jsonRoot);
    }
    return create;
})();
/**
 *
 */
bardia.dom.Element = bardia.oop.Class.create({

    initialize: function(jsonRoot) {
        this.children = [];

        if (jsonRoot instanceof HTMLElement) {
            this.wrapOnly(jsonRoot);
        } else if (jsonRoot) {
            this.createRoot(jsonRoot);
        }
    },

    wrapOnly: function(jsonRoot) {
        this.domNode = jsonRoot;
        jsonRoot.wrapper = this;
    },

    createRoot: function(jsonRoot) {
        var h = this;
        
        this.domNode = document.createElement(jsonRoot.$_tag);
        this.domNode.wrapper = this;

        for (attr in jsonRoot) {
            if (attr.indexOf(&quot;$_&quot;) != 0) {
                this.domNode.setAttribute(attr, jsonRoot[attr]);
            }
        }

        if (jsonRoot.$_append &amp;&amp; jsonRoot.$_append.forEach) {		// kolekcja obiektow w JSON
            jsonRoot.$_append.forEach(function(child) {
                h.createSubElement(child);
            });
        } else if (jsonRoot.$_append &amp;&amp; jsonRoot.$_append.$_tag) { // jeden obiekt w json
        	h.createSubElement(jsonRoot.$_append);
        } else if (jsonRoot.$_append) {
            this.domNode.innerHTML = jsonRoot.$_append;				// zwykly tekst
        }

        if (jsonRoot.$_props) {
        	this.$_props = jsonRoot.$_props
            for (prop in jsonRoot.$_props) {
            	this.domNode[prop] = jsonRoot.$_props[prop];
            }
        }
        
        if (jsonRoot.$_on) {
            for (eventName in jsonRoot.$_on) {
                this.domNode.addEventListener(eventName, jsonRoot.$_on[eventName]);
            }
        }
    },

    createSubElement: function(jsonSubElement) {
        var subElement = new bardia.dom.Element(jsonSubElement);
        this.insert(subElement);
    },

    insert: function(subElement) {
        try {
            if (subElement) {
            	if (subElement.dom) {
            		this.domNode.appendChild(subElement.dom());
            		this.children.push(subElement);
            	} else if ((typeof subElement) == &#x27;string&#x27;) {
            		var element = document.createTextNode(subElement);
            		this.domNode.appendChild(element);
            	} else if ((typeof subElement) == &#x27;number&#x27;) {
            		var element = document.createTextNode(subElement);
            		this.domNode.appendChild(element);
            	}                   
            }
        } catch (e) {
            alert(&quot;insert: subElement=&quot; + subElement + &quot; &quot; + e);
        }
        
        return subElement;
    },

    update: function(element) {
    	var h = this;
    	
    	(this.children || []).forEach(function(child) {
    		try {
	    		delete child.dom().wrapper; 
	    		h.dom().removeChild(child.dom());
    		} catch (e) {
    			console.log(&quot;error removing child node&quot;);
    		}
    	});
    	
    	if (this.children) {
    		this.children.splice(0, this.children.length);
    	}
    	
        while (this.dom().firstChild) {
            this.dom().removeChild(this.dom().firstChild);
        }

        if (element) { 
        	this.insert(element);
        }
    },

    dom: function() {
        return this.domNode;
    },

    find: function(id) {
        var result = null;
        try {
        	//result = this.domNode.querySelector(&quot;#&quot; + id);
        	result = this.domNode.querySelector(&quot;[id=&#x27;&quot; + id + &quot;&#x27;]&quot;);
        } catch (e) {
        	alert(e + &quot;   &quot; + id);
        }

        if (result !== null) {
            return result.wrapper;
        } else {
            return null;   
        }
    },
    
    findByClass: function(className) {
        var result = null;
        try {
        	result = this.domNode.querySelector(className);
        } catch (e) {
        	alert(e + &quot;   &quot; + className);
        }

        if (result != null &amp;&amp; result.wrapper) {
        	return result.wrapper;
        } else if (result != null &amp;&amp; !result.wrapper) {
        	return $_element(result);
        } else {
            return null;   
        }    	
    },

    addClassName: function(className) {
    	var classes = this.dom().classList;

    	if (!classes.contains(className)) {
    		classes.add(className);
    	}
    },

    removeClassName: function(className) {
    	var classes = this.dom().classList;

    	if (classes.contains(className)) {
    		classes.remove(className);
    	}
    },

    hasClassName: function(className) {
    	var classes = this.dom().classList;
    	return classes.contains(className);
    },
    
    clone: function() {
    	return new bardia.dom.Element(this.domNode.cloneNode(true));
    },
    
    setStyle: function(style) {
    	var s = null;
    	for (s in style) {
    		this.dom().style[s] = style[s];
    	}
    },    
});
/**
 *
 */
$_upgradeElement = (function() {
    
    function materialize(root) {
        componentHandler.upgradeElement(root.dom());
        (root.children || []).forEach(function(node) {
            $_upgradeElement(node);
        });
    }

    return materialize;
})();
bardia.cmn = {

};
/**
 * 
 */
bardia.cmn.ProgressBar = bardia.oop.Class.create({

    initialize: function(config) {		
        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
        	inside: $_element(window.document.body),
        	title: &quot;waiting for ...&quot;
        }, config || {}));
    },

    open: function() {
    	var h = this;

    	h.root = $_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;bardia-progress&quot;,
        	$_append: [{
        		$_tag: &quot;div&quot;,
        		id: &quot;_spinner&quot;,
        		class: &quot;mdl-spinner mdl-spinner--single-color mdl-js-spinner is-active&quot;,
        		style: &quot;z-index:100000001;&quot;
        	}, {
        		$_tag: &quot;div&quot;,
        		class: &quot;bardia-progress-label&quot;,
        		style: &quot;z-index:100000002;&quot;,
        		$_append: h.title
        	}]
        });
        
        $_upgradeElement(h.root.find(&quot;_spinner&quot;));
        h.inside.insert(h.root);
    },
    
    close: function() {
    	var h = this;
    	    	
    	h.inside.dom().removeChild(h.root.dom());

    	delete h.root.dom();
    	delete h.root;
    }
});
bardia.utils = {
}

function $msg(message) {
    return message;
}

bardia.utils.DateUtils = bardia.oop.Class.create({

    initialize: function(config) {

    },

    formatDateYYYYMMDD: function(date) {
    	var result = &quot;&quot;;
    	try {
    		result = date.getFullYear() + &quot;-&quot; + this.formatMM((date.getMonth() + 1)) + &quot;-&quot; + this.formatDD(date.getDate());
    	} catch (e) {
    		result = &quot;&quot;;
    	}
    	return result;
    },
    
    formatDateHHmm: function(date) {
    	var result = &quot;&quot;;
    	try {
    		result = this.formatMM((date.getHours())) + &quot;:&quot; + this.formatMM(date.getMinutes());
    	} catch (e) {
    		alert(e);
    		result = &quot;&quot;;
    	}
    	return result;
    },
    
    /**
      var du = new bardia.utils.DateUtils();
      return du.formatDateHHmm() + &quot; &quot; + du.formatDateYYYYMMDDHHmm() 
     */
    formatDateYYYYMMDDHHmm: function(date) {
    	var result = &quot;&quot;;
    	try {
    		result = date.getFullYear() + &quot;-&quot; + this.formatMM((date.getMonth() + 1)) + &quot;-&quot; + this.formatDD(date.getDate() + &quot; &quot; + this.formatHH(date.getHours())) + &quot;:&quot; + this.formatMM(date.getMinutes());
    	} catch (e) {
    		result = &quot;&quot;;
    	}
    	return result;
    },
    
    formatDateHHmmSS: function(date) {
    	var result = &quot;&quot;;
    	try {
    		result = this.formatMM(date.getHours()) + &quot;:&quot; + this.formatMM(date.getMinutes()) + &quot;:&quot; + this.formatMM(date.getSeconds());
    	} catch (e) {
    		alert(e);
    		result = &quot;&quot;;
    	}
    	return result;
    },
    
    daySecondsToHHMM: function(daySeconds) {
    	var result = &quot;&quot;;
    	
    		if (daySeconds) {
	    		var hours = (daySeconds - (daySeconds % 3600)) / 3600;
	    		
	    		var restSeconds = (daySeconds - hours * 3600);
	    		var minutes = (restSeconds - (restSeconds % 60)) / 60;
	    		
	    		result = this.formatHH(hours) + &quot;:&quot; + this.formatMM(minutes);
    		}
    		
    	return result;
    },
    /*
     * bardia.utils.DATE_FORMAT = &quot;yyyy-MM-ddTHH:mm:ss.SSS+SSSS&quot;;
     */
    parseDate: function(dateStr) {
        if (!dateStr) {
            return &quot;&quot;;
        }

        var parser = new DateParser(bardia.utils.DATE_FORMAT);
            result = parser.parse(dateStr);

        return result;
    },
    
    formatMM: function(month) {
    	if (month &lt;= 9) {
    		return &quot;0&quot; + month;
    	} else {
    		return &quot;&quot; + month;
    	}
    },
    
    formatDD: function(day) {
    	if (day &lt;= 9) {
    		return &quot;0&quot; + day;
    	} else {
    		return &quot;&quot; + day;
    	}
    },
    
    formatHH: function(hour) {
    	if (hour &lt;= 9) {
    		return &quot;0&quot; + hour;
    	} else {
    		return &quot;&quot; + hour;
    	}
    },
    
    /**
     * bardia.utils.DateUtils
     * createFormatYYYYMMDD
     */
    createFormatYYYYMMDD: function(time) {
    	var result = &quot;&quot;;
    	try {
    		if (time)
    			result = this.formatDateYYYYMMDD(new Date(time));	
    	} catch (e) {
    		alert(e);
    	}
    	return result;
    },

    createFormatHHmm: function(time) {
    	var result = &quot;&quot;;
    	try {
    		if (time)
    			result = this.formatDateHHmm(new Date(time));	
    	} catch (e) {
    		alert(e);
    	}
    	return result;
    },
    
    createFormatHHmmSS: function(time) {
    	var result = &quot;&quot;;
    	try {
    		if (time)
    			result = this.formatDateHHmmSS(new Date(time));	
    	} catch (e) {
    		alert(e);
    	}
    	return result;
    },
    /**
     * new bardia.utils.DateUtils().createFormatDateYYYYMMDDHHmm()
     */
    createFormatDateYYYYMMDDHHmm: function(time) {
    	var result = &quot;&quot;;
    	try {
    		if (time)
    			result = this.formatDateYYYYMMDDHHmm(new Date(time));	
    	} catch (e) {
    		alert(e);
    	}
    	return result;    	
    },

    getLeftMinutesTo: function(dateMillis, nowMillis) {
    	var diff = dateMillis - nowMillis;
    	var diffSec = diff / 1000;
    	var diffMins = diffSec / 60;

    	return diffMins.toFixed(0);
    },
    
    convertIntToTime: function(intValue) {
 	   var result = &quot;00:00&quot;;
 	       try {
 	    	   result = this.formatNumber(((intValue - intValue % 60) / 60), 2) + &quot;:&quot; + this.formatNumber((intValue % 60), 2)
 	       } catch (e) {
 	    	   console.log(&quot;ERROR: convertIntToTime&quot;);
 	       }
 	   return result;
    },
    
    convertDaySecondsToTime: function(daySeconds) {
  	   var result = &quot;00:00:00&quot;;
  	       try {
  	    	   var hours = (daySeconds - (daySeconds % 3600)) / 3600;
  	    	   var minutes = ((daySeconds - (hours * 3600)) / 60).toFixed(0);
  	    	   var seconds = daySeconds % 60;
  	    	   
  	    	   result = this.formatNumber(hours, 2) + &quot;:&quot; + this.formatNumber(minutes, 2) + &quot;:&quot; + this.formatNumber(seconds, 2)
  	       } catch (e) {
  	    	   console.log(&quot;ERROR: convertDaySecondsToTime&quot;);
  	       }
  	   return result;
     },
    
    formatNumber: function(num, len) {
        var result = null;
        try {
            result = &quot;&quot; + parseInt(num);
            while (result.length &lt; len) {
                result = &quot;0&quot; + result;
            }
        } catch (e) {
            alert(&quot;bardia.utils.DateUtils.formatNumber&quot; + e);
        }

        if (isNaN(parseInt(num))) {
            result = &quot;&quot;;
        }

        return result;
    },

    formatTimeSecNoZerosSec: function(date) {	
    	if (!date) {
    		return &quot;&quot;;
    	}
    	var result = this.formatNumber(date.getHours(), 2) + &quot;:&quot; + this.formatNumber(date.getMinutes(), 2);
		if (date.getSeconds() &gt; 0) {
			result += &quot;:&quot; + this.formatNumber(date.getSeconds(), 2);
		}
		return result;
    },

    formatSeconds: function(daySeconds) {
    	var result = &quot;&quot;;
    	return result;
    },

    EOW: function () {
    	return this.parseDate(&quot;4712-12-31T00:00:00.000+0000&quot;);
    },

    BOW: function () {
    	return new Date(0);
    },
    
    stripTime: function(d) {
    	var result = new Date(d.getTime());
    	result.setHours(0);
    	result.setMinutes(0);
    	result.setSeconds(0);
    	result.setMilliseconds(0);
    	return result;
    }
});

bardia.utils.DateUtils.pattern = &quot;&quot;;
bardia.utils.DATE_FORMAT = &quot;yyyy-MM-ddTHH:mm:ss.SSS+SSSS&quot;;

bardia.utils.Map = bardia.oop.Class.create({

    initialize: function() {
    	this.dict = {};
    },
    
	size: function() {
		return Object.keys(this.dict).length;
	},

	isEmpty: function() {
		return Object.keys(this.dict).length == 0;
	},

	get: function(key){
		return this.dict[key];
	},

	containsKey: function(key){
		if( this.get(key) !== undefined) {
			return true;
		} else {
			return false;
		}
	},

	put: function(key, value) {
		this.dict[key] = value;
	},

	remove: function(key) {
		&#x27;use strict&#x27;;
		delete this.dict[key];
	},

	clear: function(){
		this.dict = {};
	},

	forEach: function(callback) {
		var len = this.size();
		for (i = 0; i &lt; len; i++) {
			var item = this.get( Object.keys(this.dict)[i] );
			callback(item);
		}
	}
});

bardia.utils.onImportScriptError = function() {
	window.location.href = window.location.href;
}

bardia.utils.ScriptImporter = bardia.oop.Class.create({

	initialize: function(config) {
		bardia.oop.Class.extend(this, bardia.oop.Class.extend({
			importedScripts: new bardia.utils.Map()
		}, config));
	},

	js: function(url) {
		var h = this;

		if (h.importedScripts.containsKey(url)) {
			return;
		}

		var xhttp = new XMLHttpRequest();	

		xhttp.open(&quot;GET&quot;, url + &quot;?&quot; + new Date().getTime(), false);
		xhttp.send(null);

		if (xhttp.readyState == 4 &amp;&amp; (xhttp.status == 200 || xhttp.status == 0)) {
			try {
				h.importedScripts.put(url, {
					imported: true
				});
				globalEval(xhttp.responseText);
			} catch (e) {
				console.log(&quot;&quot; + e + &quot; Error importing script &quot; + url);
				if (bardia.utils.onImportScriptError) {
					bardia.utils.onImportScriptError(xhttp);
				}
			}
		}
	},
	
	css: function(url) {
		var h = this;

		if (h.importedScripts.containsKey(url)) {
			return;
		}

		try {
			var css = $_element({
				$_tag: &quot;link&quot;,
				rel: &quot;stylesheet&quot;,
				href: url + &quot;?&quot; + new Date().getTime()
			});
			document.getElementsByTagName(&quot;head&quot;)[0].appendChild(css.dom());
			h.importedScripts.put(url, {
				imported: true
			});
		} catch (e) {
			alert(&quot;&quot;+ e + &quot; Error importing css &quot; + url);
		}
	},
});

var globalEval = function globalEval(src) {
    if (window.execScript) {
        window.execScript(src);
        return;
    }
    var fn = function() {
        window.eval.call(window,src);
    };
    fn();
};

var IMPORTER = new bardia.utils.ScriptImporter({
});

function importScript(path) {
	IMPORTER.js(path);
};

function importCss(path) {
	IMPORTER.css(path);
};
bardia.controlls = {

};

bardia.controlls.CheckBox = bardia.oop.Class.create({

    initialize: function(config) {		
        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
        	value: false,
        	readOnly: false,
        	unselectedClass: &quot;checkbox-unselected&quot;,
        	selectedClass: &quot;checkbox-selected&quot;
        }, config));

        this.render();
    },
    
    render: function() {
    	var h = this;

    	h.root = $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:relative; width:25px; height:8px; border:0px; background:lightGrey; margin:10px 0px 0px 10px; border-radius:4px; cursor:pointer&quot;,
    		class: &quot;controlls-default&quot;,
			$_on: {
				&quot;click&quot;: function(e) {
					if (h.readOnly == false) {
						h.change();
					}
				}
			},
    		$_append: [{
    			$_tag: &quot;div&quot;,
    			id: &quot;checkbox&quot;,
    			style: &quot;position:absolute; top:-4px; width:16px; height:16px; border-radius:8px; cursor:pointer&quot;,
    			class: &quot;controlls-default&quot;,
    		}]
    	});

    	h.setValue(h.value || false);
    },
    
    getWrapper: function() {
    	var h = this;
    	return h.root;
    },
    
    select: function() {
    	var h = this;

    	h.value = true;
    	h.root.find(&quot;checkbox&quot;).removeClassName(h.unselectedClass);
    	h.root.find(&quot;checkbox&quot;).addClassName(h.selectedClass);
    },

    unselect: function() {
    	var h = this;

    	h.value = false;    	
    	h.root.find(&quot;checkbox&quot;).removeClassName(h.selectedClass);
    	h.root.find(&quot;checkbox&quot;).addClassName(h.unselectedClass);
    },

    change: function() {
    	var h = this;
    	h.setValue(!h.value);
    	
    	if (h.onChange) {
    		h.onChange(h.getValue());
    	}
    },

    setValue: function(trueOrFalse) {
    	var h = this;
    	if (trueOrFalse == true) {
    		h.select();
    	} else {
    		h.unselect();
    	}
    },
    
    getValue: function() {
    	var h = this;
    	return h.value;
    },
    
    setReadOnly: function(trueFalse) {
    	var h = this;
    	
    	h.readOnly = trueFalse || false;
    },
    
    setVisible: function(isTrue) {
    	var h = this;

    	if (isTrue === undefined) {
    		isTrue = true;
    	}
    	
    	if (true == isTrue) {
    		h.root.setStyle({
    			display: &quot;block&quot;
    		});    		
    	} else {
    		h.root.setStyle({
    			display: &quot;none&quot;
    		});
    	}
    }
});

bardia.controlls.StateBox = bardia.oop.Class.create({

    initialize: function(config) {		
        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
        	readOnly: false,
        	width: 50,
        	states: [{
        		name: &quot;State A&quot;,
        		value: &quot;A&quot;,
        		color: &quot;grey&quot;
        	}, {
        		name: &quot;State B&quot;,
        		value: &quot;B&quot;,
        		color: &quot;red&quot;
        	}, {
        		name: &quot;State C&quot;,
        		value: &quot;C&quot;,
        		color: &quot;green&quot;
        	}]
        }, config));
        
        var h = this;
        
        h.step = ((h.width) / (h.states.length - 1)).toFixed(0);
        h.currentState = 0;

        this.render();
    },
    
    render: function() {
    	var h = this;

    	h.root = $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:relative; width:&quot; + h.width + &quot;px; height:8px; border:0px; background:lightGrey; margin:10px 0px 0px 10px; border-radius:4px; cursor:pointer&quot;,
    		class: &quot;controlls-default&quot;,
			$_on: {
				&quot;click&quot;: function(e) {
					if (h.readOnly == false) {
						h.change();
					}
				}
			},
    		$_append: [{
    			$_tag: &quot;div&quot;,
    			id: &quot;checkbox&quot;,
    			style: &quot;position:absolute; top:-4px; width:16px; height:16px; border-radius:8px; cursor:pointer; background-color:&quot; + (h.states[0].color || &quot;black&quot;),
    			class: &quot;controlls-default&quot;,
    		}]
    	});

    	if (h.value) {
    		h.setValue(h.value || h.states[0].value);
    	}
    },
    
    setValue: function(value) {
    	var h = this;
    	
    	var index = h.getValueIndex(value);
    	h.setState(index);    	
    },
    
    getValueIndex: function(value) {
    	var h = this;
    	var i=0;
    	for (i=0; i&lt;h.states.length; i++) {
    		if (value == h.states[i].value) {
    			return i;
    		}
    	}
    	return 0;
    },
    
    setState: function(index) {
    	var h = this;
    	
    	var oldValue = h.value;
    	
    	h.root.find(&quot;checkbox&quot;).setStyle({
    		left: (-8 + h.step*index) + &quot;px&quot;,
    		backgroundColor: h.states[index].color
    	});
    	h.value = h.states[index].value;
    	h.currentIndex = index;
    	
    	if (h.onChange &amp;&amp; h.value != oldValue) {
    		h.onChange(h.value,h.states[index].name);
    	}
    },

    getWrapper: function() {
    	var h = this;
    	return h.root;
    },
    
    change: function() {
    	var h = this;
    	
    	if (h.currentIndex &lt; h.states.length - 1) {
    		h.setState(h.currentIndex + 1);
    	} else {
    		h.setState(0);
    	}
    },
    
    getValue: function() {
    	return this.value;
    },
    
    setReadOnly: function(trueOrFalse) {
    	var h = this;
    	h.readOnly = trueOrFalse || false;
    }
});

bardia.controlls.ScrollingCell = bardia.oop.Class.create({

	initialize : function(config) {
		bardia.oop.Class.extend(this, bardia.oop.Class.extend({
			value: &quot;title&quot;
		}, config));
		
		this.render();
	},

	render: function() {
		var h = this;

		h.root = $_element({
			$_tag: &quot;span&quot;,
			class: &quot;controlls-scrolling-element&quot;,
			style: &quot;top:0px; overflow:visible; width:unset; right:unset;&quot;,
			$_append: h.value,
			title: h.value,
			$_on: {
				mouseover: function(e) {
					h.startScrolling();
				},
				mouseout: function(e) {
					h.stopScrolling();
				}
			}
		});
		
		h.autoscroll();
	},
	
	autoscroll: function() {
		var h = this;
		
		h.interval = setInterval(function() {
			h.startScrolling();
			
			setTimeout(function() {
				h.stopScrolling();
			}, 10000);
		}, 30000);
	},
	
	startScrolling: function() {
		var h = this;
		
		if (h.root.dom().parentElement.getClientRects()[0] &amp;&amp; h.root.dom().getClientRects()[0] &amp;&amp; h.root.dom().parentElement.getClientRects()[0].width &lt; h.root.dom().getClientRects()[0].width) {
			h.root.dom().style.left = -(h.root.dom().getClientRects()[0].width - h.root.dom().parentElement.getClientRects()[0].width) + &quot;px&quot;;
		}
	},
	
	stopScrolling: function() {
		var h = this;
		
		h.root.dom().style.left = &quot;0px&quot;;
	},

	getMaterial: function() {
		return this.root;
	}
});	
bardia.layout = {
};
/**
 * @class bardia.layout.BorderLayout
 * @constructor
 *
@example
~~~
var layout = new bardia.layout.BorderLayout({
   root: $_element(document.body),
   north: {
        height: 20
   }
});
~~~
 */
bardia.layout.BorderLayout = bardia.oop.Class.create({

	initialize: function(config) {
		bardia.oop.Class.extend(this, bardia.oop.Class.extend({
			serial: &quot;BL_&quot; + (Math.random()*1000000).toFixed(0),
		}, config));
        
		try {
			this.render();
		} catch (e) {
			alert(&quot;BorderLayout.render: &quot; + e);
		}
	},

    render: function() {
    	var h = this;
    	
    	h.root = $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:absolute; top:0px; left:0px; right:0px; bottom:0px; overflow:hidden;&quot;
    	});
    	
    	h.inside.update(h.root);
        
        var centerTop = 0;
        var centerBottom = 0;
        var centerLeft = 0;
        var centerRight = 0;

        if (h.north !== undefined) {
            centerTop = h.north.height || 50;
            
            h.northElement = $_element({
                $_tag: &quot;div&quot;,
                class: &quot;border-layout-north&quot;,
                style: &quot;height:&quot; + centerTop + &quot;px; background-color:&quot; + (h.north.fill || &quot;transparent&quot;)
            });

            h.root.insert(h.northElement);
        }
        
        if (h.south !== undefined) {
            centerBottom = h.south.height || 50;

            h.southElement = $_element({
                $_tag: &quot;div&quot;,
                class: &quot;border-layout-south&quot;,
                style: &quot;height:&quot; + centerBottom + &quot;px; background-color:&quot; + (h.south.fill || &quot;transparent&quot;)
            });
            
            h.root.insert(h.southElement);
        }
        
        if (h.west !== undefined) {
            centerLeft = h.west.width || 50;
            
            h.westElement = $_element({
                $_tag: &quot;div&quot;,
                style: &quot;position:absolute; overflow:hidden; top:&quot; + centerTop + &quot;px; left:0px; width:&quot; + centerLeft + &quot;px; bottom:&quot; + centerBottom + &quot;px; background-color:&quot; + (h.west.fill || &quot;transparent&quot;)
            });

            h.root.insert(h.westElement);
        }
        
        if (h.east !== undefined) {
            centerRight = h.east.width || 50;

            h.eastElement = $_element({
                $_tag: &quot;div&quot;,
                style: &quot;position:absolute; overflow:hidden; top:&quot; + centerTop + &quot;px; right:0px; width:&quot; + centerRight + &quot;px; bottom:&quot; + centerBottom + &quot;px; background-color:&quot; + (h.east.fill || &quot;transparent&quot;)
            });

            h.root.insert(h.eastElement);
        }

        h.centerElement = $_element({
            $_tag: &quot;div&quot;,
            style: &quot;position:absolute; overflow:hidden; top:&quot; + centerTop + &quot;px; left:&quot; + centerLeft + &quot;px; right:&quot; + centerRight + &quot;px; bottom:&quot; + centerBottom + &quot;px; background-color:&quot; + (h.fill || &quot;transparent&quot;)
        });

        h.root.insert(h.centerElement);
    },
    id: function(name) {
    	return this.serial + name;
    },
    getNorth: function() {
        return this.northElement;
    },
    getWest: function() {
        return this.westElement;
    },
    getEast: function() {
        return this.eastElement;
    },
    getSouth: function() {
        return this.southElement;
    },
    getCenter: function() {
        return this.centerElement;
    },
    getDefault: function() {
        return this.centerElement;
    },
    openDetails: function(width) {
        var h = this;

        h.root.insert($_element({
            $_tag: &quot;div&quot;,
            class: &quot;panel-animated&quot;,
            style: &quot;position:absolute; top:0px; left:0px; bottom:0px; width:0px; background-color:transparent&quot;,
            id: h.id(&quot;panel-details-curtain&quot;),
            $_on: {
                &quot;click&quot;: function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            },
        }));
        
        h.root.insert($_element({
            $_tag: &quot;div&quot;,
            class: &quot;panel-details-right&quot;,
            id: h.id(&quot;panel-details-right&quot;),
            $_on: {
                &quot;click&quot;: function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            },
        }));

        var result = h.root.find(h.id(&quot;panel-details-right&quot;));
        h.detailsWidth = width || h.detailsWidth;

        setTimeout(function() {
            h.root.find(h.id(&quot;panel-details-right&quot;)).addClassName(&quot;is-active&quot;);
            h.root.find(h.id(&quot;panel-details-right&quot;)).dom().style.left = &quot;0px&quot;;
            h.root.find(h.id(&quot;panel-details-right&quot;)).dom().style.width = h.detailsWidth;

            h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.width = &quot;100%&quot;;
            h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.backgroundColor = &quot;rgba(0,0,0,0.6)&quot;;

            //result.update(); 	
        }, 50);
       
        return result;
    },
    
    closeDetails: function() {
        var h = this;

        if (h.root.find(h.id(&quot;panel-details-right&quot;)) != null) {
		    h.root.find(h.id(&quot;panel-details-right&quot;)).removeClassName(&quot;is-active&quot;);
		    h.root.find(h.id(&quot;panel-details-right&quot;)).dom().style.left = &quot;-&quot; + h.detailsWidth;
		    
		    h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.width = &quot;0px&quot;;
		    h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.backgroundColor = &quot;transparent&quot;;
		    
		    setTimeout(function() {
		    	h.root.find(h.id(&quot;panel-details-right&quot;)).dom().remove();
		    	h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().remove();
		    }, 1000);
        }
    },
});
/**

Materia, ktry wysuwa si po wywoaniu metody show().
Po wywoaniu metody hide() - ucieka.
Moe si wysuwa z rznych stron: left, right, top, button.
Jeeli jest modalny to podczas wysuwania pojawia sie pod nim pprzeroczysta kurtyna, ktra sprawia,
e kontet parenta jest lekko zasonity.

Animacja odbywa si w ten sposb, e materia si wysuwa z jednej ze stron parenta (na przykad na gridzie, parenta podajemy w inside) a w tym czasie kurtyna zasania obaszar grida.
Komponent jest appendowany do inside&#x27;a - czyli nie podmienia jego zawartoci.

@class bardia.layout.Material
@constructor new bardia.lazout.Material();
@param config {JSONObject}
@param config.inside {bardia.dom.Element}
@param config.size=30 {Integer}
@param config.unit=&#x27;%&#x27; {String -&gt; &#x27;px&#x27;|&#x27;%&#x27;}
@param config.edge=&#x27;left&#x27; {String -&gt; &#x27;top&#x27;|&#x27;right&#x27;|&#x27;bottom&#x27;|&#x27;left&#x27;}
@param config.modal=false {Boolean -&gt; true|false}
 
@example
~~~
var material = new bardia.layout.Material({
   inside: $_element(document.body),
   size: 90,
   unit: &quot;%&quot;,
   edge: &quot;left&quot;
});

material.show();

material.getContent().insert($_element({
    $_tag: &quot;DIV&quot;,
    $_append: &quot;this is div content&quot;
}));

~~~
 */
bardia.layout.Material = (function() {

    var h = this;

    function Material(config) {
    }

    /**
     * @method show()
     */
    Material.prototype.show = function() {
        
    }
    
    /**
     * @method hide()
     */
    Material.prototype.hide = function() {

    }
    
    /**
     * @method getContent()
     * @return {bardia.dom.Element}
     */
    Material.prototype.getContent = function() {

    }
    
    return Material;
})();

bardia.layout.Panel = bardia.oop.Class.create({

    initialize: function(config) {
        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
            title: &quot;Insert title here ...&quot;,
            serial: &quot;S_&quot; + (Math.random()*1000000).toFixed(0),
            color: &quot;white&quot;
        }, config));

        this.render();
    },

    render: function() {
        var h = this;

        h.prepareRoot();
        h.inside.update(h.root);

        h.setButtons(h.buttons);
    },

    setButtons: function(buttons) {
    	var h = this;

    	h.buttons = buttons;
    	h.btnElements = [];

    	h.root.find(h.id(&quot;toolbar&quot;)).update();

    	if (h.buttons) {
    		h.buttons.forEach(function(button, index) {    			    		
    			var btn = $_element({
    				$_tag: &quot;button&quot;,
    				class: &quot;mdl-button mdl-js-button mdl-button--icon&quot;,
					style: &quot;margin-right:&quot; + ((index == h.buttons.length-1)?10:0) + &quot;px; color:&quot; + (button.color || h.color),
    				title: button.name,
    				$_append: [{
    					$_tag: &quot;i&quot;,
    					class: &quot;material-icons&quot;,
    					$_append: button.icon
    				}],
    				$_on: {
    					&quot;click&quot;: function(e) {
    						button.onClick();
    					}
    				}
    			});
    			
    			if (button.access != undefined &amp;&amp; button.access != null &amp;&amp; button.access != bardia.VISIBLE) {
    				btn.setStyle({
    					display: &quot;none&quot;
    				});
    			}
    			
    			h.root.find(h.id(&quot;toolbar&quot;)).insert(btn);
    			h.btnElements.push(btn);
    		});
    	}

    	h.root.find(h.id(&quot;toolbar&quot;)).insert(h.title || &quot;&quot;);
    },
    
    getContent: function() {
    	return this.root.find(this.id(&quot;contents&quot;));
    },

    prepareRoot: function() {
        var h = this;
        
        h.root = $_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;panel-container&quot;,
        	$_append: [{
        		$_tag: &quot;div&quot;,
        		id: h.id(&quot;toolbar&quot;),
        		class: &quot;panel-top panel-bg&quot;,
        		$_append: h.title
        	}, {
        		$_tag: &quot;div&quot;,
        		class: &quot;panel-content&quot;,
        		id: h.id(&quot;contents&quot;)
        	}]
        });

        h.root.insert($_element({
            $_tag: &quot;div&quot;,
            class: &quot;panel-animated&quot;,
            style: &quot;position:absolute; top:0px; left:0px; bottom:0px; width:0px; background-color:transparent&quot;,
            id: h.id(&quot;panel-details-curtain&quot;),
            $_on: {
                &quot;click&quot;: function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            },
        }));
        
        h.root.insert($_element({
            $_tag: &quot;div&quot;,
            class: &quot;panel-details-right&quot;,
            id: h.id(&quot;panel-details-right&quot;),
            $_on: {
                &quot;click&quot;: function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            },
        }));

        h.lock = $_element({
    		$_tag: &quot;div&quot;,
    		id: &quot;lock_sheet&quot;,
    		style: &quot;position:absolute; top:47px; left:0px; right:16px; bottom:0px; display:none; background:transparent&quot;,
    		$_append: [{
    			$_tag: &quot;div&quot;,
    			style: &quot;position:absolute; top:50px; right:50px; line-height:30px; height:30px; display:flex; flex-direction:row-reverse&quot;,
    			$_append: [{
					$_tag: &quot;i&quot;,
					class: &quot;material-icons&quot;,
					style: &quot;color:red; line-height:30px;&quot;,
					$_append: &quot;lock&quot;
				}, {
					$_tag: &quot;div&quot;,
					style: &quot;background:rgba(255,255,255,0.7); margin-right:10px; border-radius:10px; line-height:30px; border:1px solid grey; padding:0px 10px 0px 10px;&quot;,
					id: h.id(&quot;lock_description&quot;)
				}]
    		}]
    	});
        h.root.insert(h.lock);

        h.root.insert($_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;bardia-progress&quot;,
        	id: h.id(&quot;panel-progress&quot;),
        	$_append: [{
        		$_tag: &quot;div&quot;,
        		class: &quot;bardia-progress-label-container&quot;,
        		$_append: [{
            		$_tag: &quot;div&quot;,
            		class: &quot;material-icons bardia-progress-icon&quot;,
            		$_append: &quot;replay&quot;
            	}, {
            		$_tag: &quot;div&quot;,
            		id: h.id(&quot;panel-progress-label&quot;),
            		class: &quot;bardia-progress-label&quot;
            	}]
        	}]
        }));
    },

    id: function(name) {
    	return this.serial + name;
    },

    openDetails: function(width) {
        var h = this;

        h.detailsWidth = width || h.detailsWidth;

        h.root.find(h.id(&quot;panel-details-right&quot;)).addClassName(&quot;is-active&quot;);
        h.root.find(h.id(&quot;panel-details-right&quot;)).dom().style.left = &quot;0px&quot;;
        h.root.find(h.id(&quot;panel-details-right&quot;)).dom().style.width = h.detailsWidth;

        h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.width = &quot;100%&quot;;
        h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.backgroundColor = &quot;rgba(0,0,0,0.6)&quot;;

        var result = h.root.find(h.id(&quot;panel-details-right&quot;));
        	result.update();

        return result;
    },
    
    closeDetails: function() {
        var h = this;

        h.root.find(h.id(&quot;panel-details-right&quot;)).removeClassName(&quot;is-active&quot;);
        h.root.find(h.id(&quot;panel-details-right&quot;)).dom().style.left = &quot;-&quot; + h.detailsWidth;
        
        h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.width = &quot;0px&quot;;
        h.root.find(h.id(&quot;panel-details-curtain&quot;)).dom().style.backgroundColor = &quot;transparent&quot;;
    },

    setTitle: function(title) {
    	var h = this;
    	h.title = title;

    	h.setButtons();
    },

    getButton: function(index) {
    	var h = this;

    	if (h.btnElements.length &gt; index) {
    		return h.btnElements[index];	
    	}
    	return null;
    },

    blinkButton: function(index, color) {
    	var h = this;

    	var buttonElement = h.getButton(index);
    	if (null !== buttonElement) {
    		h.oldColor = buttonElement.dom().style.color; 
    		buttonElement.setStyle({
    			color: color
    		});
    		buttonElement.addClassName(&quot;panel-button-blinked&quot;);
    	}
    	return buttonElement;
    },
    
    unblinkButton: function(index) {
    	var h = this;

    	var buttonElement = h.getButton(index);
    	if (null !== buttonElement) {
    		buttonElement.setStyle({
    			color: h.oldColor
    		});
    		buttonElement.removeClassName(&quot;panel-button-blinked&quot;);
    	}
    	return buttonElement;
    },
    
    hideButton: function(index) {
    	var h = this;
    	var buttonElement = h.getButton(index);
    	if (null !== buttonElement) {
    		buttonElement.setStyle({
    			display: &quot;none&quot;
    		});
    	}
    	return buttonElement;
    },

    showButton: function(index) {
    	var h = this;
    	var buttonElement = h.getButton(index);
    	if (null !== buttonElement) {
    		buttonElement.setStyle({
    			display: &quot;block&quot;
    		});
    	}
    	return buttonElement;
    },

    lockPanel: function(icon, message) {
    	var h = this;

    	h.lock.setStyle({
    		display: &quot;block&quot;,
    		background: &quot;rgba(0,0,0,0.2)&quot;
    	}); 
    	
    	h.lock.find(h.id(&quot;lock_description&quot;)).update((message || &quot;no_lock_message&quot;));
    },

    openProgress: function(message) {
    	var h = this;
    	h.root.find(h.id(&quot;panel-progress&quot;)).addClassName(&quot;bardia-progress-is-active&quot;);
    	h.root.find(h.id(&quot;panel-progress-label&quot;)).update((message || &quot;...&quot;));
    },

    closeProgress: function() {
    	var h = this;
    	h.root.find(h.id(&quot;panel-progress&quot;)).removeClassName(&quot;bardia-progress-is-active&quot;);
    },
    
    updateProgress: function(message) {
    	var h = this;
    	h.root.find(h.id(&quot;panel-progress-label&quot;)).update((message || &quot;...&quot;));
    }
});
bardia.layout.BreadCrumb = bardia.oop.Class.create({
    
    initialize: function(config) {
    	bardia.oop.Class.extend(this, bardia.oop.Class.extend({
    		tabs: [],
    		serial: &quot;S_&quot; + (Math.random()*1000000).toFixed(0),
    	}, config));
    	
    	this.render();
    },
    
    render: function() {
        var h = this;

        h.root = h.prepareRoot();
        h.inside.update(h.root);
    },

    addItem: function(tab) {
    	var h = this;

    	var headerLink = $_element({
    		$_tag: &quot;div&quot;,
    		class: &quot;breadcrumb-link&quot;,
    		$_append: tab.name,
    		$_on: {
    			&quot;click&quot;: function(e) {
    				h.selectItem(e.target.wrapper);
    			}
    		}
    	});
    	headerLink.tab = tab;
    	    	
    	h.root.find(h.id(&quot;header&quot;)).insert(headerLink);
    	
    	var content = $_element({
    		$_tag: &quot;div&quot;,
    		class: &quot;breadcrumb-content&quot;
    	});
    	h.root.find(h.id(&quot;contents&quot;)).insert(content);
    	
    	headerLink.content = content;
    	
    	if (h.lastItem) {
			h.lastItem.nextItem = headerLink;
    	} 
    	
    	h.selectItem(headerLink);
    },
    
    selectItem: function(wrappedElement) {
    	var h = this;

    	if (h.lastItem) {		
    		h.lastItem.removeClassName(&quot;is-active&quot;);
    		h.lastItem.content.removeClassName(&quot;is-active&quot;);
    		
        	wrappedElement.previousItem = h.lastItem; 
    	}

    	h.removeAllNextItems(wrappedElement);

    	h.lastItem = wrappedElement;

    	wrappedElement.addClassName(&quot;is-active&quot;);
    	wrappedElement.content.addClassName(&quot;is-active&quot;);

		if (wrappedElement.tab.onActivate &amp;&amp; !wrappedElement.activated) {
			wrappedElement.activated = true;
			wrappedElement.tab.onActivate(wrappedElement.content, wrappedElement);
		}
    },

    removeAllNextItems: function(headerLink) {    	
    	var selectedLink = headerLink;
    	
    	var toBeRemoved = [];
    	while (selectedLink.nextItem) {
    		toBeRemoved.push(selectedLink.nextItem);
    		selectedLink = selectedLink.nextItem;
    	}

    	headerLink.nextItem = null;
    	delete headerLink.nextItem;
    	
    	toBeRemoved.forEach(function(header) {
    		header.dom().remove();
    		header.content.dom().remove();
    		
    		if (header.nextItem) {
    			delete header.nextItem;
    		}
    	});
    },
    
    removeLastItem: function() {
    	var h = this;
    	
    	if (h.lastItem &amp;&amp; h.lastItem.previousItem) {
    		h.removeAllNextItems(h.lastItem.previousItem);
    	}
    },

    prepareRoot: function() {
    	var h = this;
    	
        var json = {
            $_tag: &quot;div&quot;, 
            class: &quot;breadcrumb-container&quot;,
            $_append: [{
                $_tag: &quot;main&quot;, 
                class: &quot;breadcrumb-contents&quot;, 
                id: h.id(&quot;contents&quot;),
            }, {
                $_tag: &quot;div&quot;, 
                class: &quot;breadcrumb-header breadcrumb-bg&quot;, 
                id: h.id(&quot;header&quot;),
            }]
        };

        return $_element(json);
    },
    
    id: function(name) {
    	return this.serial + name;
    }
});
bardia.layout.Tabs = bardia.oop.Class.create({
    
    initialize: function(config) {
    	bardia.oop.Class.extend(this, bardia.oop.Class.extend({
    		tabs: [],
    		addedTabs: [],
    		serial: &quot;S_&quot; + (Math.random()*1000000).toFixed(0),
    	}, config));
    	
    	this.render();
    },
    
    render: function() {
        var h = this;
        
        h.headerLinks = [];

        h.root = h.prepareRoot();
        h.inside.update(h.root);

        var headerLink = null;
        h.tabs.forEach(function(tab) {
        	if (tab.access == undefined) {
        		tab.access = bardia.VISIBLE;
        	}
        	if (tab.access &gt; bardia.INVISIBLE) {
        		h.headerLinks.push(h.addItem(tab));
        	}
        });
        
        if (h.headerLinks &amp;&amp; h.headerLinks.length &gt; 0) {
        	h.selectItem(h.headerLinks[h.headerLinks.length - 1]);
        }
    },

    addItem: function(tab) {
    	var h = this;

    	var headerLink = $_element({
    		$_tag: &quot;div&quot;,
    		class: &quot;tabs-link&quot;,
    		$_append: tab.name,
    		$_on: {
    			&quot;click&quot;: function(e) {
    				h.selectItem(e.target.wrapper);
    			}
    		}
    	});
    	headerLink.tab = tab;
    	headerLink.id = tab.id;
    	
    	h.root.find(h.id(&quot;header&quot;)).insert(headerLink);
    	
    	var content = $_element({
    		$_tag: &quot;div&quot;,
    		class: &quot;tabs-content&quot;
    	});
    	h.root.find(h.id(&quot;contents&quot;)).insert(content);
    	
    	headerLink.content = content;

    	return headerLink;
    },
    
    selectItemByIndex: function(index) {
    	var h = this;
    	if (h.headerLinks &amp;&amp; index &gt;= 0 &amp;&amp; index &lt; h.headerLinks.length) {
    		return h.selectItem(h.headerLinks[index]);
    	} else {
    		return h.selectItem(h.headerLinks[h.headerLinks.length - 1]);
    	}
    },
    
    selectItemById: function(id) {
    	var h = this;

    	if (h.headerLinks) {
    		var theLink = null;
    		h.headerLinks.forEach(function(headerLink) {
    			if (headerLink.id &amp;&amp; headerLink.id == id) {
    				theLink = headerLink;
    			}
    		});
    		
    		if (theLink != null) {
    			return h.selectItem(theLink);
    		}
    	}
    },
    
    selectItem: function(wrappedElement) {
    	var h = this;

    	if (h.selectedItem) {		
    		h.selectedItem.removeClassName(&quot;is-active&quot;);
    		h.selectedItem.content.removeClassName(&quot;is-active&quot;);
    	}
    	
    	h.selectedItem = wrappedElement;

    	wrappedElement.addClassName(&quot;is-active&quot;);
    	wrappedElement.content.addClassName(&quot;is-active&quot;);

		if (wrappedElement.tab.onActivate &amp;&amp; !wrappedElement.activated) {
			wrappedElement.activated = true;
			wrappedElement.tab.onActivate(wrappedElement.content);
		} 

		if (wrappedElement.tab.onSelect) {
			wrappedElement.tab.onSelect(wrappedElement.content);
		} 
		
		return wrappedElement.content;
    },

    prepareRoot: function() {
    	var h = this;
    	
        var json = {
            $_tag: &quot;div&quot;, 
            class: &quot;tabs-container&quot;,
            $_append: [{
                $_tag: &quot;main&quot;, 
                class: &quot;tabs-contents&quot;, 
                id: h.id(&quot;contents&quot;),
            }, {
                $_tag: &quot;div&quot;, 
                class: &quot;tabs-header tabs-bg&quot;, 
                id: h.id(&quot;header&quot;),
            }]
        };

        return $_element(json);
    },
    
    id: function(name) {
    	return this.serial + name;
    }
});
bardia.list = {

};
/**
 *
 */
bardia.list.List = bardia.oop.Class.create({
    /**
     *
     */
    initialize: function(config) {
        this.config = config;
        
        this.render();
    },
    /**
     *
     */
    render: function() {
        var h = this;
        
        h.config.inside.update();

        h.root = $_element({
            $_tag: &quot;table&quot;,
            class: &quot;mdl-data-table mdl-js-data-table mdl-shadow--2dp&quot;,
            $_append: [{
                $_tag: &quot;thead&quot;,
                $_append: [{
                    $_tag: &quot;tr&quot;,
                    $_append: [{
                        $_tag: &quot;th&quot;,
                        class: &quot;mdl-data-table__cell--non-numeric&quot;,
                        style: &quot;background-color:yellow&quot;,
                        $_append: &quot;A&quot;
                    }, {
                        $_tag: &quot;th&quot;,
                        $_append: &quot;B&quot;
                    }, {
                        $_tag: &quot;th&quot;,
                        $_append: &quot;C&quot;
                    }]
                }]
            }, {
                $_tag: &quot;tbody&quot;,
                $_append: [{
                    $_tag: &quot;tr&quot;,
                    $_append: [{
                        $_tag: &quot;td&quot;,
                        class: &quot;mdl-data-table__cell--non-numeric&quot;,
                        $_append: &quot;Grzegorz&quot;
                    }, {
                        $_tag: &quot;td&quot;,
                        $_append: [{
                            $_tag: &quot;INPUT&quot;,
                            type: &quot;number&quot;
                        }]
                    }, {
                        $_tag: &quot;td&quot;,
                        $_append: &quot;Julia&quot;
                    }]
                }, {
                    $_tag: &quot;tr&quot;,
                    $_append: [{
                        $_tag: &quot;td&quot;,
                        class: &quot;mdl-data-table__cell--non-numeric&quot;,
                        $_append: &quot;Agnieszka&quot;
                    }, {
                        $_tag: &quot;td&quot;,
                        $_append: &quot;BBB&quot;
                    }, {
                        $_tag: &quot;td&quot;,
                        $_append: &quot;CCC&quot;
                    }]
                }]
            }]
        });
        
        h.config.inside.insert(h.root);
        
        $_upgradeElement(h.root);
    }
});
/**
 *
 */
bardia.list.MobileList = (function() {
    
    var h = this;
    
    function prepareRoot() {
        var result = $_element({
            $_tag: &quot;ul&quot;,
            class: &quot;collection with-header&quot;,
            $_append: [{
                $_tag: &quot;li&quot;,
                class: &quot;collection-header&quot;,
                $_append: &quot;&lt;h4&gt;First Names&lt;/h4&gt;&quot;
            }, {
                $_tag: &quot;li&quot;,
                class: &quot;collection-item&quot;,
                $_append: &quot;Wojtek&quot;
            }, {
                $_tag: &quot;li&quot;,
                class: &quot;collection-item&quot;,
                $_append: &quot;Ela&quot;
            }, {
                $_tag: &quot;li&quot;,
                class: &quot;collection-item&quot;,
                $_append: &quot;Piotr&quot;,
                $_on: {
                    &quot;click&quot;: function(e) {
                        alert(e);
                    }
                }
            }]
        });

        return result;
    }

    function _mobileList(config) {
        var root = prepareRoot();
        config.inside.insert(root);
    };

    return _mobileList;
})();

/*
      &lt;ul class=&quot;collection with-header&quot;&gt;
        &lt;li class=&quot;collection-header&quot;&gt;&lt;h4&gt;First Names&lt;/h4&gt;&lt;/li&gt;
        &lt;li class=&quot;collection-item&quot;&gt;Alvin&lt;/li&gt;
        &lt;li class=&quot;collection-item&quot;&gt;Alvin&lt;/li&gt;
        &lt;li class=&quot;collection-item&quot;&gt;Alvin&lt;/li&gt;
        &lt;li class=&quot;collection-item&quot;&gt;Alvin&lt;/li&gt;
      &lt;/ul&gt;
 */
bardia.grid = {

};

bardia.grid.Grid = bardia.oop.Class.create({

    detailsWidth: &quot;400px&quot;,
    /**
     * 
     */
    initialize: function(config) {
        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
        	title: &quot;Insert tile here. . .&quot;,
        	clickAfterFetch: false,
        	serial: &quot;S_&quot; + (Math.random()*1000000).toFixed(0),
        	visibleRowsCount: 0
        }, config));

        this.render();
    },
    /**
     * 
     */
    render: function() {
        var h = this;
        
        h.root = $_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;grid-container&quot;,
        	$_append:[{
        		$_tag: &quot;div&quot;,
        		id: h.id(&quot;toolbar&quot;),
        		class: &quot;grid-top grid-bg&quot;,
        	}, {
	            $_tag: &quot;div&quot;,
	            class: &quot;grid-content&quot;,
	            $_append: [{
	                $_tag: &quot;div&quot;,
	                class: &quot;grid-headers&quot;,
	                id: h.id(&quot;grid-headers&quot;),
	                $_append: h.columns.map(function(column, index) {
	                    return {
	                        $_tag: &quot;div&quot;,
	                        class: &quot;grid-header&quot;,
	                        id: &quot;grid-column-index&quot; + index,
	                        style: &quot;width:&quot; + (column.width || 150) + &quot;px&quot;,
	                        $_props: {
		                        property: column.property,
		                        sorter: column.sorter,
	                        },
	                        $_append: [{
	                        	$_tag: &quot;div&quot;,
	                        	id: &quot;grid_column_title_&quot; + index,
	                        	style: &quot;position:relative; overflow:hidden; width:&quot; + ((column.width || 150) - 15) + &quot;px;&quot;,
	                        }, {
	                        	$_tag: &quot;div&quot;,
	        	                class: &quot;material-icons grid-column-header-sort&quot;,
	        	                id: &quot;sort-asc&quot;,
	        	                style: &quot;position:absolute; right:0px; top:-35px; color:#707E85; cursor:pointer;&quot;,
	        	                $_append: &quot;keyboard_arrow_down&quot;
	                        }, {
	                        	$_tag: &quot;div&quot;,
	        	                class: &quot;material-icons grid-column-header-sort&quot;,
	        	                id: &quot;sort-desc&quot;,
	        	                style: &quot;position:absolute; right:0px; top:60px; color:#707E85; cursor:pointer;&quot;,
	        	                $_append: &quot;keyboard_arrow_up&quot;
	                        }],
	                        $_on: {
	                        	click: function(e) {
	                        		h.sortByColumn(h.root.find(&quot;grid-column-index&quot; + index));
	                        	}
	                        }
	                    };
	                })
	            }, {
	                $_tag: &quot;div&quot;,
	                class: &quot;grid-rows&quot;,
	                id: h.id(&quot;grid-rows&quot;),
	                $_on: {
	                    &quot;click&quot;: function(e) {
	                    	var element = e.target; 
	                    	while(element.className &amp;&amp; element.className.indexOf(&quot;grid-row-&quot;) &lt; 0) {
	                    		element = element.parentElement;
	                    	}
	                    	if (element.wrapper &amp;&amp; element.className &amp;&amp; element.className.indexOf(&quot;grid-row-&quot;) &gt;= 0) {
	                    		if (h.onClick) {
	                    			h.onClick(element.wrapper);
	                    		}
	                    	} else {
	                    		console.log(&quot;Element dont have wrapper .....&quot;);
	                    	}
	                    },
	                    &quot;mouseover&quot;: function(e) {
	                    	var element = e.target; 
	                    	while(element.className &amp;&amp; element.className.indexOf(&quot;grid-row-&quot;) &lt; 0) {
	                    		element = element.parentElement;
	                    	}
	                    	if (element.wrapper &amp;&amp; element.className &amp;&amp; element.className.indexOf(&quot;grid-row-&quot;) &gt;= 0) {
	                    		if (h.onMouseOver) {
	                    			h.onMouseOver(element.wrapper);
	                    		}
	                    	}
	                    },
	                    &quot;scroll&quot;: function(e) {
                			if (h.onScrollTop) {
                				h.onScrollTop(e.target.scrollTop);
                			}
	                    }
	                }
	            }]
        	}, {
                $_tag: &quot;div&quot;,
                class: &quot;grid-curtain&quot;,
                id: h.id(&quot;grid-curtain&quot;),
                $_on: {
                    &quot;click&quot;: function() {
                        //h.closeDetails();
                    }
                },
                $_append: [{
                    $_tag: &quot;div&quot;,
                    class: &quot;grid-details-right&quot;,
                    id: h.id(&quot;grid-details-right&quot;),
                    style: &quot;width:&quot; + h.detailsWidth + &quot;; left:-&quot; + h.detailsWidth, 
                    $_on: {
                    	&quot;click&quot;: function(e) {
                    		e.stopPropagation();
                    	}
                    }
                }]
            }]
        });

        h.root.insert($_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;bardia-progress&quot;,
        	id: h.id(&quot;grid-progress&quot;),
        	$_append: [{
        		$_tag: &quot;div&quot;,
        		class: &quot;bardia-progress-label-container&quot;,
        		$_append: [{
            		$_tag: &quot;div&quot;,
            		class: &quot;material-icons bardia-progress-icon&quot;,
            		$_append: &quot;replay&quot;
            	}, {
            		$_tag: &quot;div&quot;,
            		id: h.id(&quot;grid-progress-label&quot;),
            		class: &quot;bardia-progress-label&quot;
            	}]
        	}]
        }));

        h.inside.update(h.root);

        h.columns.forEach(function(column, index) {
			var mat = new bardia.controlls.ScrollingCell({
				value: column.name
			}).getMaterial();
			h.root.find(&quot;grid_column_title_&quot; + index).update(mat);
        });

		h.setButtons(h.buttons);
		h.setTitle(h.title);
		h.createSearchField();
    },
    /**
     * 
     */
    setScrollTop: function(pixels) {
    	var h = this;
    		h.root.find(h.id(&quot;grid-rows&quot;)).dom().scrollTop = pixels;
    },
    /**
     * 
     */
    getScrollTop: function() {
    	var h = this;
		return h.root.find(h.id(&quot;grid-rows&quot;)).dom().scrollTop;
    },
    /**
     * 
     */
    selectRowByBean: function(bean) {
    	var h = this;
    	for(var i=0; i&lt;h.rowsElements.length; i++) {
    		if (h.rowsElements[i].bean === bean) {
    			h.rowsElements[i].dom().click();
    			h.rowsElements[i].dom().focus();
    			break;
    		}
    	}
    },
    /**
     * 
     */
    findRowByBean: function(bean) {
    	var h = this;
    	var result = null;
    	
    	for(var i=0; i&lt;h.rowsElements.length; i++) {
    		if (h.rowsElements[i].bean === bean) {
    			result = h.rowsElements[i];
    			break;
    		}
    	}

    	return result;
    },
    /**
     * 
     */
    selectRowByAttribute: function(attribute, value) {
    	var h = this;
    	for(var i=0; i&lt;h.rowsElements.length; i++) {
    		if (h.rowsElements[i].bean[attribute] === value) {
    			h.rowsElements[i].dom().click();
    			h.rowsElements[i].dom().focus();
    			break;
    		}
    	}
    },
    /**
     * 
     */
    sortByColumn: function(columnHeader) {
    	var h = this;

    	if (h.sortedColumn) {
    		if (h.sortedColumn == columnHeader) {
    			h.reverseSorting(h.sortedColumn);
    		} else {
    			h.hideSorting(h.sortedColumn);
    			h.reverseSorting(columnHeader);
    		}
    	} else {
    		h.reverseSorting(columnHeader);
    	}
    	
    	h.sortedColumn = columnHeader;
    	h.sort(h.sortedColumn);
    },
    /**
     * 
     */
    sortByColumnIndex: function(index) {
    	var h = this;
	    	h.sortByColumn(h.root.find(&quot;grid-column-index&quot; + index));
    },
    /**
     * 
     */
    reverseSorting: function(columnHeader) {
    	var h = this;
    	
    	if (!columnHeader.sortAsc) {
    		columnHeader.sortAsc = true;
    	} else {
    		columnHeader.sortAsc = !columnHeader.sortAsc;
    	}
    	
    	if (true == columnHeader.sortAsc) {
    		columnHeader.find(&quot;sort-asc&quot;).setStyle({
        		top: &quot;10px&quot;
        	});
    		columnHeader.find(&quot;sort-desc&quot;).setStyle({
        		top: &quot;60px&quot;
        	});    		
    	} else {
    		columnHeader.find(&quot;sort-asc&quot;).setStyle({
        		top: &quot;-30px&quot;
        	});
    		columnHeader.find(&quot;sort-desc&quot;).setStyle({
        		top: &quot;10px&quot;
        	});    		
    	}
    },
    /**
     * 
     */
    hideSorting: function(columnHeader) {
    	var h = this;
    	
    	columnHeader.find(&quot;sort-desc&quot;).setStyle({
    		top: &quot;60px&quot;
    	});
    	columnHeader.find(&quot;sort-asc&quot;).setStyle({
    		top: &quot;-30px&quot;
    	});
    },
    /**
     * 
     */
    setButtons: function(buttons) {
    	var h = this;

    	h.buttons = buttons;
    	h.root.find(h.id(&quot;toolbar&quot;)).update();

    	if (h.buttons) {
    		h.buttons.forEach(function(button, index) {
    			var el = $_element({
    				$_tag: &quot;button&quot;,
    				class: &quot;mdl-button mdl-js-button mdl-button--icon&quot;,
    				title: button.name,
    				$_append: [{
    					$_tag: &quot;div&quot;,
    					class: &quot;icon material-icons grid-icon&quot;,
    					style: button.style || &quot;&quot;,
    					$_append: button.icon,
    				}],
    				$_on: {
    					&quot;click&quot;: function(e) {
    						button.onClick();
    					}
    				}
    			});
    			h.root.find(h.id(&quot;toolbar&quot;)).insert(el);
    		});
    	}

		var el = $_element({
			$_tag: &quot;div&quot;,
			id: h.id(&quot;grid_title&quot;),
			class: &quot;grid-title&quot;,
			$_append: &quot;[&quot; + h.getVisibleRowsCount() + &quot;] &quot; + h.title
		});

    	h.root.find(h.id(&quot;toolbar&quot;)).insert(el);
    },
    
    setTitle: function(title) {
    	var h = this;
		h.title = title;
		//h.root.find(h.id(&quot;grid_title&quot;)).update(&quot;[&quot; + h.getVisibleRowsCount() +&quot;] &quot; + h.title);
		h.root.find(h.id(&quot;grid_title&quot;)).update(h.title);
    },

    createSearchField: function() {
    	var h = this;
    	
    	h.textSearch = $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:relative; display:flex; flex-direction:row; top:3px; line-height:30px;  margin:0px; padding:0px;&quot;,
    		$_append: [{
    			$_tag: &quot;div&quot;,
    			id: &quot;search_div&quot;,
    			style: &quot;overflow:hidden; width:0px; margin-left:20px; padding:0px;&quot;,
    			class: &quot;grid-animated&quot;,
    			$_append: [{
    				$_tag: &quot;input&quot;,
    				class: &quot;mdl-textfield__input&quot;,
    				style: &quot;background-color:transparent; font-size:14px; font-family:Arial; margin-bottom:4px; outline:none; box-shadow:none; border:1px solid white; border-width:0px 0px 1px 0px;&quot;,
    				type: &quot;text&quot;,
    				name: &quot;sample&quot;,
    			    id: h.id(&quot;search_input&quot;),
    			    $_on: {
    			    	keyup: function(e) {
    			    		h.filterRows(e.target.value);
    			    	},
    			    	blur: function(e) {
    			    		if (!e.target.value || e.target.value == &quot;&quot; || e.target.value == null) {
    			    			h.textSearch.find(&quot;search_div&quot;).dom().style.width = &quot;0px&quot;;
    			    		}
    			    	}
    			    }
    			}],
    		}, {
    			$_tag: &quot;div&quot;,
    			&quot;for&quot;: h.id(&quot;search_input&quot;),
    			id: h.id(&quot;search_icon&quot;),
    			$_append: [{
    				$_tag: &quot;i&quot;,
    				class: &quot;material-icons&quot;,
    				style: &quot;cursor:pointer&quot;,
    				$_append: &quot;search&quot;
    			}],
    			$_on: {
			    	click: function() {
			    		h.textSearch.find(&quot;search_div&quot;).dom().style.width = &quot;150px&quot;;
			    		h.textSearch.find(h.id(&quot;search_input&quot;)).dom().focus();
			    	}
    			}
    		}]
    	});
    	
    	h.root.find(h.id(&quot;toolbar&quot;)).insert(h.textSearch);
    	
    	$_upgradeElement(h.textSearch);
    },
    /**
     * 
     */
    sort: function(columnHeader) {
    	var h = this;

    	if (h.model &amp;&amp; h.model.rows) {
    		var sorter = undefined;
    		var props = columnHeader.$_props;

    		if (props.sorter) {
    			sorter = function(a, b) {
    				return props.sorter(a, b);
        		}
    		} else if (props.property) {
    			sorter = function(a, b) {
    				if (a[props.property] &amp;&amp; b[props.property]) {
    					return (&quot;&quot; + a[props.property]).localeCompare(&quot;&quot; + b[props.property]);
    				} else {
    					return 0;
    				}
        		}
    		}

    		if (sorter) {
	    		h.model.rows.sort(function(a, b) {
	    			if (true == columnHeader.sortAsc) {
	    				return sorter(a, b);	
	    			} else {
	    				return sorter(b, a);
	    			}
	    		});

	    		setTimeout(function() {
	    			h.fetchNoSort(h.model);
	    		}, 500);
    		}
    	}
    },
    getVisibleRowsCount: function() {
    	return this.visibleRowsCount;
    },
    /**
     * 
     */
    fetch: function(model) {
        var h = this;
        
        if (h.model) {
        	delete h.model;
        }
        h.model = model;
        
        h.visibleRowsCount = model.rows.length;
                
        if (undefined == h.sortedColumn) {
        	h.fetchNoSort(h.model);
        } else {        	
        	h.sort(h.sortedColumn);
        }
        
        var filterValue = h.textSearch.find(h.id(&quot;search_input&quot;)).dom().value;
        if (filterValue &amp;&amp; filterValue.trim() != &quot;&quot;) {
        	h.filterRows(filterValue);
        }

        h.setTitle(h.title);
    },
    /**
     * 
     */
    fetchNoSort: function(model) {
        var h = this;

        if (h.rowsElements) {
        	delete h.rowsElements;
        }
        h.rowsElements = [];

        var rowsDiv = h.root.find(h.id(&quot;grid-rows&quot;));
        rowsDiv.update();

        h.firstRow = undefined;

        (model.rows || []).forEach(function(row, index) {
            var rowDiv = $_element({
                $_tag: &quot;div&quot;,
                class: &quot;grid-row-&quot;,
                tabIndex: index
            });
            rowsDiv.insert(rowDiv);
        	rowDiv.bean = row;

        	h.rowsElements.push(rowDiv);

            h.columns.forEach(function(column) {            	
            	var cell = $_element({
                    $_tag: &quot;div&quot;,
                    class: &quot;grid-cell&quot;,
                    style: &quot;width:&quot; + (column.width || 150) + &quot;px&quot;,
                });

            	if (column.render) {
            		var rendered = column.render(rowDiv, cell);	
            		if (rendered &amp;&amp; rendered != null &amp;&amp; rendered.$_tag &amp;&amp; rendered.$_tag != null) {
            			cell.insert($_element(rendered));
            		} else if (rendered &amp;&amp; rendered.dom !== undefined) {
            			cell.insert(rendered);
            		} else {
            			cell.insert(&quot;&quot; + rendered);
            		}
            	} else {
            		var value = eval(&quot;rowDiv.bean.&quot; + column.property);
            		if (value === undefined || value === null) {
            			value = &quot;&quot;;
            		}
                	cell.insert(&quot;&quot; + value);
            	}

                rowDiv.insert(cell);
            });
        });

//        if (h.clickAfterFetch == true) {
//        	if (h.firstRow) {
//        		h.firstRow.dom().click();
//        	}
//        }        
    },
    /**
     * 
     */
    filterRows: function(value) {
    	var h = this;

    	h.visibleRowsCount = 0;
    	
    	if (h.textSearch.find(h.id(&quot;search_input&quot;)).dom().value !== value) {
    		h.textSearch.find(h.id(&quot;search_input&quot;)).dom().value = value;
    		h.textSearch.find(h.id(&quot;search_icon&quot;)).dom().click();
    	}
    	
    	var values = value.toLowerCase().split(&quot; &quot;);
    	
    	var rowsDiv = h.root.find(h.id(&quot;grid-rows&quot;));
    	
    	h.firstRow = undefined;

    	for (var i=0; i&lt;rowsDiv.dom().childNodes.length; i++) {
    		var cellValue = rowsDiv.dom().childNodes[i].innerHTML.toLowerCase();
    		
    		var exists = false;
    		values.some(function(val) {
    			if(cellValue.indexOf(val.trim()) &gt;= 0) {
    				exists = true;
    				return true;
    			}
    		});

    		if (true == exists) {
    			rowsDiv.dom().childNodes[i].style.display = &quot;flex&quot;;
    			h.firstRow = h.firstRow || rowsDiv.dom().childNodes[i]; 
    			h.visibleRowsCount++;
    		} else {
    			rowsDiv.dom().childNodes[i].style.display = &quot;none&quot;;
    		}
    	}
    	
        if (h.clickAfterFetch == true) {
        	if (h.firstRow) {
        		h.firstRow.click();
        	}
        }

    	if (h.onFiltered) {
    		h.onFiltered();
    	}
    },
    
    getVisibleBeans: function() {
    	var h = this;

    	var beans = [];
    	
    	h.rowsElements.forEach(function(row) {
			if (row.dom().style.display == &quot;flex&quot;) {
				beans.push(row.bean);
			}    		
    	});
    	
    	return beans;
    },

    openDetails: function(width) {
        var h = this;

        h.detailsWidth = width || h.detailsWidth;

        h.root.find(h.id(&quot;grid-curtain&quot;)).dom().style.width = &quot;100%&quot;;
        h.root.find(h.id(&quot;grid-curtain&quot;)).dom().style.background = &quot;rgba(0,0,0,0.5)&quot;;
        h.root.find(h.id(&quot;grid-details-right&quot;)).dom().style.left = &quot;0px&quot;;
        h.root.find(h.id(&quot;grid-details-right&quot;)).dom().style.width = h.detailsWidth;
        
        var result = h.root.find(h.id(&quot;grid-details-right&quot;));
        result.update();

        return result;
    },

    closeDetails: function() {
        var h = this;

        h.root.find(h.id(&quot;grid-curtain&quot;)).dom().style.width = &quot;0px&quot;;
        h.root.find(h.id(&quot;grid-curtain&quot;)).dom().style.background = &quot;rgba(0,0,0,0.0)&quot;;
        h.root.find(h.id(&quot;grid-details-right&quot;)).dom().style.left = &quot;-&quot; + h.detailsWidth;
    },

    id: function(name) {
    	return this.serial + name;
    },

    openProgress: function(message) {
    	var h = this;
    	h.root.find(h.id(&quot;grid-progress&quot;)).addClassName(&quot;bardia-progress-is-active&quot;);
    	if (message) {
    		h.root.find(h.id(&quot;grid-progress-label&quot;)).update(message); 		
    	}
    },

    closeProgress: function() {
    	var h = this;
    	h.root.find(h.id(&quot;grid-progress&quot;)).removeClassName(&quot;bardia-progress-is-active&quot;);
    },
});
bardia.form = {

};
/**
 *
 */
bardia.form.Form = bardia.oop.Class.create({

    detailsWidth: &quot;400px&quot;,

    initialize: function(config) {
        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
            title: &quot;Insert title here ...&quot;,
            serial: &quot;S_&quot; + (Math.random() * 1000000).toFixed(0),
            buttons: []
        }, config));

        this.render();
    },

    render: function() {
        var h = this;

        h.prepareRoot();
        h.inside.update(h.root);
        
        h.setButtons(h.buttons || []);
    },

    setButtons: function(buttons) {
    	var h = this;
    	
    	h.buttons = buttons;

		h.root.find(h.id(&quot;toolbar&quot;)).update();
		h.buttons.forEach(function(button) {
			h.root.find(h.id(&quot;toolbar&quot;)).insert($_element({
				$_tag: &quot;button&quot;,
				class: &quot;mdl-button mdl-js-button mdl-button--icon&quot;,
				title: button.name,
				$_append: [{
					$_tag: &quot;i&quot;,
					class: &quot;material-icons form-icon&quot;,
					style: button.style || &quot;&quot;,
					$_append: button.icon
				}],
				$_on: {
					&quot;click&quot;: function(e) {
						if (button.onClick) {
							button.onClick();
						}
					}
				}
			}));
		});
		
		var el = $_element({
			$_tag: &quot;div&quot;,
			class: &quot;form-title&quot;,
			id: &quot;form_title&quot;,
			$_append: h.title
		});

    	h.root.find(h.id(&quot;toolbar&quot;)).insert(el);
    },
    
    setTitle: function(title) {
    	var h = this;
    	
    	h.title = title;

    	h.setButtons(h.buttons);
    },

    prepareRoot: function() {
        var h = this;
        
        h.root = $_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;form-container&quot;,
        	$_append: [{
        		$_tag: &quot;div&quot;,
        		id: h.id(&quot;toolbar&quot;),
        		class: &quot;form-top form-bg&quot;
        	}, {
        		$_tag: &quot;div&quot;,
        		class: &quot;form-content&quot;,
        		id: h.id(&quot;contents&quot;)
        	}]
        });

        h.formFields = [];
        h.fields.forEach(function(field) {
            var _field = bardia.oop.Class.extend({
                type: &quot;Text&quot;
            }, field);

            var formField = eval(&quot;new bardia.form.&quot; + _field.type + &quot;Field(_field)&quot;);
            h.formFields.push(formField);

            formField.setForm(h);
            
            h.root.find(h.id(&quot;contents&quot;)).insert(formField.getElement());
        });

        h.root.insert($_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-curtain&quot;,
            id: h.id(&quot;form-curtain&quot;),
            style: &quot;width:0px&quot;,
            $_on: {
                &quot;click&quot;: function() {
                    //h.closeDetails();
                }
            },
            $_append: [{
                $_tag: &quot;div&quot;,
                class: &quot;form-details-right&quot;,
                id: h.id(&quot;form-details-right&quot;),
                $_on: {
                    &quot;click&quot;: function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                },
            }]
        }));

        h.root.insert($_element({
        	$_tag: &quot;div&quot;,
        	class: &quot;form-progress&quot;,
        	id: h.id(&quot;form-progress&quot;),
        	$_append: [{
        		$_tag: &quot;div&quot;,
        		id: h.id(&quot;progress&quot;),
        		class: &quot;mdl-spinner mdl-spinner--single-color mdl-js-spinner&quot;
        	}, {
        		$_tag: &quot;div&quot;,
        		id: h.id(&quot;form-progress-label&quot;),
        		class: &quot;form-progress-label form-bg&quot;
        	}]
        }));
        
        $_upgradeElement(h.root.find(h.id(&quot;progress&quot;)));
    },
    
    validate: function() {
    	var h = this;
    	
    	var result = true;

    	h.formFields.forEach(function(formField) {
    		result = formField.validate() &amp;&amp; result;
    	});

    	return result;
    },

    addBeanChangedListener: function(listener) {
        var h = this;
        h.beanListeners = h.beanListeners || [];
        h.beanListeners.push(listener);
    },

    setBean: function(bean) {
        this.bean = bean;

        (this.beanListeners || []).forEach(function(listener) {
            listener(bean);
        });
    },

    getBean: function() {
    	this.bean = this.bean || {};
        return this.bean || {};
    },

    openDetails: function(width) {
        var h = this;

        h.detailsWidth = width || h.detailsWidth;

        h.root.find(h.id(&quot;form-curtain&quot;)).dom().style.width = &quot;100%&quot;;
        h.root.find(h.id(&quot;form-curtain&quot;)).dom().style.background = &quot;rgba(0,0,0,0.7)&quot;;
        h.root.find(h.id(&quot;form-details-right&quot;)).dom().style.left = &quot;0px&quot;;
        h.root.find(h.id(&quot;form-details-right&quot;)).dom().style.width = h.detailsWidth;
        
        var result = h.root.find(h.id(&quot;form-details-right&quot;));
        	result.update();

        return result;
    },
    
    closeDetails: function() {
        var h = this;

        h.root.find(h.id(&quot;form-curtain&quot;)).dom().style.width = &quot;0px&quot;;
        h.root.find(h.id(&quot;form-curtain&quot;)).dom().style.background = &quot;rgba(0,0,0,0.0)&quot;;
        h.root.find(h.id(&quot;form-details-right&quot;)).dom().style.left = &quot;-&quot; + h.detailsWidth;
    },

    openProgress: function(message) {
    	var h = this;
    	h.root.find(h.id(&quot;form-progress&quot;)).addClassName(&quot;form-progress-is-active&quot;);
    	h.root.find(h.id(&quot;progress&quot;)).addClassName(&quot;is-active&quot;);
    	h.root.find(h.id(&quot;form-progress-label&quot;)).update((message || &quot;...&quot;));
    },

    closeProgress: function() {
    	var h = this;
    	h.root.find(h.id(&quot;form-progress&quot;)).removeClassName(&quot;form-progress-is-active&quot;);
    	h.root.find(h.id(&quot;progress&quot;)).removeClassName(&quot;is-active&quot;);
    },
    
    setProgressLabel: function(label) {
    	var h = this;
    	
    	h.root.find(h.id(&quot;form-progress-label&quot;)).update(label);
    },
    
    id: function(name) {
    	return this.serial + name;
    },
    
    findFieldByProperty: function(propertyName) {
    	var h = this;
    	var result = null;
    	h.formFields.forEach(function(fieldControl) {
    		if (fieldControl.property &amp;&amp; propertyName == fieldControl.property) {
    			result = fieldControl;
    		}
    	});
    	return result;
    }
});
bardia.form.TextField = bardia.oop.Class.create({

    initialize: function(config) {

        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
            label: &quot;Insert title here ...&quot;,
            serial: &quot;S_&quot; + (Math.random()*1000000).toFixed(0),
            readOnly: false,
            visible: true,
            required: false,
            detailsWidth: &quot;90%&quot;,
            maxLength: 255
        }, config));

        this.render();
    },

    render: function() {
        var h = this;

        h.root = $_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-row&quot;,
            $_append: [{
                $_tag: &quot;input&quot;,
                class: &quot;form-text-input&quot;,
                required: false,
                id: h.id(h.property),
                maxLength: h.maxLength || 255,
                $_on: {
                    change: function(e) {
                        h.updateBeanProperty(e.target.value);
                    },
//                    focus: function(e) {
//                    	if (h.readOnly == true) {
//                    		e.stopPropagation();
//                    		e.target.blur();
//                    	}
//                    },
                    keyup: function(e) {
                    	if (h.onKeyUp) {
                    		h.onKeyUp(e.target.value);
                    	}
                    },
                    keydown: function(e) {
                    	if (h.readOnly == true) {
                    		e.stopPropagation();
                    		e.target.blur();
                    	}                    	
                    }
                }
            }, {
                $_tag: &quot;label&quot;,
                class: &quot;form-text-input-label&quot;,
                id: h.id(&quot;label&quot;),
                $_append: h.label,
                $_on: {
                	click: function() {
                		h.root.find(h.id(h.property)).dom().focus();
                	}
                }
            }]
        });
        
        h.applyAttributes();
        
        h.prepareMask();
    },
    
    applyAttributes: function() {
    	var h = this;
    	
        h.setReadOnly(h.readOnly);
        h.setVisible(h.visible);
        h.setRequired(h.required);
    },
    
	prepareMask: function() {
		var h = this;

		if (h.mask) {
			var mask = new InputMask(h.mask, h.root.find(h.id(h.property)).dom());
			mask.updateFunction = function(_mask) {
				h.updateBeanProperty(_mask.control.value);
			}
		}
		
		// do nothing for simple text
	},

    setReadOnly: function(trueOrFalse) {
    	var h = this;

    	h.readOnly = trueOrFalse;
    	if (true == trueOrFalse) {
    		h.root.find(h.id(h.property)).readOnly = true;
    		h.root.find(h.id(h.property)).addClassName(&quot;form-text-input-readonly&quot;);
    	} else {
    		h.root.find(h.id(h.property)).readOnly = false;
    		h.root.find(h.id(h.property)).removeClassName(&quot;form-text-input-readonly&quot;);
    	}
    },
    
    setRequired: function(trueOrFalse) {
    	var h = this;

    	h.required = trueOrFalse;
        if (trueOrFalse == true) {
            h.root.find(h.id(&quot;label&quot;)).update(&quot;* &quot; + h.label);
        } else {
        	h.root.find(h.id(&quot;label&quot;)).update(h.label);
        }
    },

    getElement: function() {
        var h = this;
        return h.root;
    },

    updateBeanProperty: function(value) {
        var h = this;        
        eval(&quot;h.form.getBean().&quot; + h.property + &quot; = value;&quot;);
        //
		if (h.onChange) {
			h.onChange(value);
		}
    },

    updateInputValue: function() {
        var h = this;
        var val = eval(&quot;h.form.getBean().&quot; + h.property);
        if (val === undefined) {
        	val = &quot;&quot;;
        }
        h.root.find(h.id(h.property)).dom().value = val;
    },
    
    validate: function() {
    	var h = this;
    	
    	var result = true;
    	
    	try {
	    	if (true === h.required &amp;&amp; (!h.root.find(h.id(h.property)).dom().value || h.root.find(h.id(h.property)).dom().value.trim() == &quot;&quot;)) {
	    		h.markError();
	    		result = false;
	    	}

	    	if (h.mask) {
		    	if (result == true &amp;&amp; h.mask &amp;&amp; h.root.find(h.id(h.property)).dom().value.length &lt; h.mask.length &amp;&amp; true == h.required &amp;&amp; h.root.find(h.id(h.property)).dom().value.length &gt; 0) {
		    		h.markError();
		    		result = false;
		    	} 
	    	}
	    	
	    	if (result == true) {
	    		h.unmarkError();
	    	}
    	} catch (e) {
    		alert(&quot;bardia.form.TextField -&gt; eror property -&gt; &quot; + h.property);
    	}
    	
    	return result;
    },
    
    markError: function() {
    	var h = this;
    	h.root.find(h.id(&quot;label&quot;)).addClassName(&quot;form-text-input-label-error&quot;);
    },
    
    unmarkError: function() {
    	var h = this;
    	h.root.find(h.id(&quot;label&quot;)).removeClassName(&quot;form-text-input-label-error&quot;);
    },

    setForm: function(form) {
    	try {
	        var h = this;
	        h.form = form;
	        h.form.addBeanChangedListener(function(bean) {
	            h.updateInputValue(bean);
	        });
    	} catch (e) {
    		alert(&quot;&quot; + e);
    	}
    },
    
    id: function(name) {
    	return this.serial + name;
    },
    
    setVisible: function(trueOrFalse) {
    	var h = this;
    	
    	h.visible = trueOrFalse;
    	if (true == trueOrFalse) {
    		h.root.removeClassName(&quot;bardia-not-visible&quot;);
    	} else {
    		h.root.addClassName(&quot;bardia-not-visible&quot;);
    	}
    }
});
/**
 * 
 */
bardia.form.ActionField = bardia.oop.Class.inherit(bardia.form.TextField, {

    render: function() {
        var h = this;

        h.root = $_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-row&quot;,
            $_append: [{
                $_tag: &quot;input&quot;,
                class: &quot;form-text-input&quot;,
                required: true,
                type: &quot;text&quot;,
                id: h.id(h.property),
                $_on: {
                    change: function(e) {
                        h.updateBeanProperty(e.target.value);
                    },
                    keydown: function(e) {
                    	e.stopPropagation();
                    	e.preventDefault();
                    },
                    mousedown: function(e) {
                    	e.stopPropagation();
                    	e.preventDefault();
                    }
                }
            }, {
                $_tag: &quot;label&quot;,
                class: &quot;form-text-input-label&quot;,
                &quot;for&quot;: h.property,
                id: h.id(&quot;label&quot;),
                $_append: h.label
            }]
        });

        h.actionButton = h.displayButton();
        h.root.insert(h.actionButton);

        h.setReadOnly(h.readOnly);
        h.setVisible(h.visible);
        h.setRequired(h.required);
    },
    /**
     *  
     */
    displayButton: function() {
    	var h = this;

    	return $_element({
            $_tag: &quot;button&quot;,
            class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
            $_on: {
                click: function(e) {
                    var element = h.form.openDetails(&quot;100%&quot;);
                    if (h.onExpand) {
                    	h.onExpand(element);
                    }
                }
            },
            $_append: [{
                $_tag: &quot;i&quot;,
                class: &quot;material-icons&quot;,
                $_append: &quot;keyboard_arrow_down&quot;,
            }]
        });
    },
    
    id: function(name) {
    	return this.serial + name;
    },
    
    setReadOnly: function(trueOrFalse) {
    	var h = this;

    	h.readOnly = trueOrFalse;
    	if (true == trueOrFalse) {
    		h.root.find(h.id(h.property)).addClassName(&quot;form-text-input-readonly&quot;);
    		h.actionButton.addClassName(&quot;bardia-not-visible&quot;);
    	} else {
    		h.root.find(h.id(h.property)).removeClassName(&quot;form-text-input-readonly&quot;);
    		h.actionButton.removeClassName(&quot;bardia-not-visible&quot;);
    	}
    },
});

bardia.form.DateField = bardia.oop.Class.inherit(bardia.form.ActionField, {
    
    initialize: function(config) {

        bardia.oop.Class.extend(this, bardia.oop.Class.extend({
            label: &quot;Insert title here ...&quot;,
            serial: &quot;S_&quot; + (Math.random()*1000000).toFixed(0),
            readOnly: false,
            visible: true,
            required: false,
            date: new bardia.utils.DateUtils().stripTime(new Date()),
            du: new bardia.utils.DateUtils()
        }, config));

        this.render();
    },

    displayButton: function() {
    	var h = this;

    	return $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:absolute; bottom:0px; left:170px; display:&quot; + ((h.readOnly==true)?&quot;none&quot;:&quot;flex&quot;) + &quot;; flex-direction:row&quot;,
    		$_append: [{
                $_tag: &quot;button&quot;,
                class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
                $_on: {
                    click: function(e) {
                        var element = h.form.openDetails(&quot;295px&quot;);
                        try {
                        	h.displayCalendar(element);
                        } catch (e) {
                        	alert(e);
                        }
                    }
                },
                $_append: [{
                    $_tag: &quot;i&quot;,
                    class: &quot;material-icons action-icon&quot;,
                    $_append: &quot;today&quot;,
                }]
            }, {
                $_tag: &quot;button&quot;,
                class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
                $_on: {
                    click: function(e) {
                    	h.updateBeanProperty(undefined);
                    	h.updateInputValue(h.form.getBean());
                    }
                },
                $_append: [{
                    $_tag: &quot;i&quot;,
                    class: &quot;material-icons action-delete-icon&quot;,
                    $_append: &quot;cancel&quot;,
                }]
            }]
    	});
    },

    displayCalendar: function(html) {    	
    	var h = this;

    	h.calendarRoot = $_element({
    		$_tag: &quot;div&quot;,
    		class: &quot;calendar-container&quot;,
    		$_append: [{
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-weekday&quot;,
    			id: &quot;weekday&quot;
    		}, {
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-month&quot;,
    			id: &quot;month&quot;
    		}, {
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-month-day&quot;,
    			id: &quot;month-day&quot;
    		}, {
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-year&quot;,
    			id: &quot;year&quot;
    		}, {
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-navigation&quot;,
    			id: &quot;month-navigation&quot;,
    			$_append: [{
    	            $_tag: &quot;div&quot;,
    	            class: &quot;material-icons mdl-button mdl-js-button mdl-button--icon calendar-nav-icon&quot;,
    	            $_append: &quot;keyboard_arrow_left&quot;,
    	            style: &quot;top:5px; left:5px;&quot;,
    	            $_on: {
    	                click: function(e) {
    	                	h.minusMonth();
    	                }
    	            },
    	        }, {
    	        	$_tag: &quot;div&quot;,
    	        	id: &quot;month-full-name&quot;,
    	        	style: &quot;position:absolute; top:0px; left:30px; right:30px; height:40px; text-align:center;&quot;
    	        }, { 
    	            $_tag: &quot;div&quot;,
    	            class: &quot;material-icons mdl-button mdl-js-button mdl-button--icon calendar-nav-icon&quot;,
    	            $_append: &quot;keyboard_arrow_right&quot;,
    	            style: &quot;top:5px; right:5px;&quot;,
    	            $_on: {
    	                click: function(e) {
    	                	h.plusMonth();
    	                }
    	            },
    	        }]
    		}, {
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-days&quot;,
    			id: &quot;month-days&quot;,
    		}, {
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-buttons&quot;,
    			id: &quot;month-buttons&quot;
    		}, { 
	            $_tag: &quot;div&quot;,
	            class: &quot;material-icons mdl-button mdl-js-button mdl-button--icon calendar-nav-icon&quot;,
	            $_append: &quot;cancel&quot;,
	            style: &quot;top:5px; right:5px; color:white;&quot;,
	            title: &quot;Cancel&quot;,
	            $_on: {
	                click: function(e) {
	                	h.form.closeDetails();
	                }
	            },
	        }],
    	});

    	html.insert(h.calendarRoot);
    	    	
    	h.updateDaysView();
    },
    
    plusMonth: function() {
    	var h = this;
    	h.date.setMonth(h.date.getMonth() + 1);
    	h.updateDaysView();
    },
    
    minusMonth: function() {
    	var h = this;
    	h.date.setMonth(h.date.getMonth() - 1);
    	h.updateDaysView();
    },
    
    updateDaysView: function() {
    	var h = this;
    	
    	h.date = h.date || eval(&quot;h.form.getBean().&quot; + h.property) || h.du.stripTime(new Date());    	
    	
    	h.calendarRoot.find(&quot;month-days&quot;).update();
    	var days = h.prepareDaysRows();
    	days.forEach(function(_day) {
    		h.calendarRoot.find(&quot;month-days&quot;).insert($_element(_day));
    	});

    	h.setWeekday();
    	h.setMonth();
    	h.setMonthFullName();
    	h.setMonthDay();
    	h.setYear();
    },

    prepareDaysRows: function() {
    	var h = this;
    	
    	var result = [];

    	var clonedDate = new Date(h.date.getTime());
    	clonedDate.setDate(1);
    	clonedDate.setHours(0);
    	clonedDate.setMinutes(0);
    	clonedDate.setSeconds(0);
    	clonedDate.setMilliseconds(0);

    	var currentMonth = clonedDate.getMonth();

    	clonedDate.setTime(clonedDate.getTime() - (clonedDate.getDay()*24*60*60*1000));

    	var i = 0;
    	for (i=0; i&lt;=41; i++) {
    		var aDate = new Date(clonedDate.getTime() + (i * 24 * 60 * 60 * 1000));
    		
    		var clazz = &quot;calendar-not-today&quot;;
    		if (aDate.getMonth() == currentMonth) {
    			color = &quot;black&quot;;

    			if (aDate.getDay() == 0) {
    				color = &quot;red&quot;;
    			}

    			if (aDate.getDate() == h.date.getDate()) {
    				clazz = &quot;calendar-today&quot;;
    			}
    		}

    		result.push({
    			$_tag: &quot;div&quot;,
    			class: &quot;calendar-single-day mdl-js-ripple-effect &quot; + clazz,
    			$_props: {
    				date: aDate
    			},
    			$_on: {
    				click: function(e) {
    					h.updateBeanProperty(e.target.date.getTime());
    					h.updateInputValue(h.form.getBean());
    					h.form.closeDetails();
    				}
    			},
    			$_append: &quot;&quot; + aDate.getDate()
    		});
    	}

    	return result;
    },

    updateInputValue: function(bean) {
        var h = this;
        var date = new Date(eval(&quot;bean.&quot; + h.property));
        if (date) {
        	h.root.find(h.id(h.property)).dom().value = h.du.createFormatYYYYMMDD(date.getTime());
        }
    },

    setWeekday: function() {
    	this.calendarRoot.find(&quot;weekday&quot;).update(bardia.form.DateField.WEEKDAYS[this.date.getDay()]);
    },
    
    setMonth: function() {
    	this.calendarRoot.find(&quot;month&quot;).update(bardia.form.DateField.SHORT_MONTHS[this.date.getMonth()]);
    },
    
    setMonthFullName: function() {
    	this.calendarRoot.find(&quot;month-full-name&quot;).update(bardia.form.DateField.MONTHS[this.date.getMonth()]);
    },
    
    setMonthDay: function() {
    	this.calendarRoot.find(&quot;month-day&quot;).update(&quot;&quot; + this.date.getDate());
    },

    setYear: function() {
    	this.calendarRoot.find(&quot;year&quot;).update(&quot;&quot; + this.date.getFullYear());
    },
});

bardia.form.DateField.WEEKDAYS = [&quot;SUNDAY&quot;, &quot;MONDAY&quot;, &quot;TUESDAY&quot;, &quot;WEDNESDAY&quot;, &quot;THURSDAY&quot;, &quot;FRIDAY&quot;, &quot;SATURDAY&quot;];
bardia.form.DateField.MONTHS = [&quot;JANUARY&quot;, &quot;FEBRUARY&quot;, &quot;MARCH&quot;, &quot;APRIL&quot;, &quot;MAY&quot;, &quot;JUNE&quot;, &quot;JULY&quot;, &quot;AUGUST&quot;, &quot;SEPTEMBER&quot;, &quot;OCTOBER&quot;, &quot;NOVEMBER&quot;, &quot;DECEMBER&quot;];
bardia.form.DateField.SHORT_MONTHS = [&quot;JAN&quot;, &quot;FEB&quot;, &quot;MAR&quot;, &quot;APR&quot;, &quot;MAY&quot;, &quot;JUN&quot;, &quot;JUL&quot;, &quot;AUG&quot;, &quot;SEP&quot;, &quot;OCT&quot;, &quot;NOV&quot;, &quot;DEC&quot;];
bardia.form.DateField.DU = new bardia.utils.DateUtils();

bardia.form.LookupField = bardia.oop.Class.inherit(bardia.form.ActionField, {

    displayButton: function() {
    	var h = this;

//    	h.actionButton = $_element({
//            $_tag: &quot;button&quot;,
//            class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
//            id: &quot;btn&quot;,
//            $_on: {
//                click: function(e) {
//                    var element = h.form.openDetails(h.detailsWidth);
//                    if (h.onExpand) {
//                    	h.onExpand(element);
//                    }
//                }
//            },
//            $_append: [{
//                $_tag: &quot;i&quot;,
//                class: &quot;material-icons action-icon&quot;,
//                $_append: &quot;keyboard_arrow_down&quot;,
//            }]
//        });
//    	return h.actionButton;
    	
    	return $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:absolute; bottom:0px; left:170px; display:&quot; + ((h.readOnly==true)?&quot;none&quot;:&quot;flex&quot;) + &quot;; flex-direction:row&quot;,
    		$_append: [{
                $_tag: &quot;button&quot;,
                class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
                $_on: {
                    click: function(e) {
                        var element = h.form.openDetails(h.detailsWidth);
                        if (h.onExpand) {
                        	h.onExpand(element);
                        }
                    }
                },
                $_append: [{
                    $_tag: &quot;i&quot;,
                    class: &quot;material-icons action-icon&quot;,
                    $_append: &quot;keyboard_arrow_down&quot;,
                }]
            }, {
                $_tag: &quot;button&quot;,
                class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
                $_on: {
                    click: function(e) {
                    	h.updateBeanProperty(undefined);
                    	h.updateInputValue(h.form.getBean());
                    }
                },
                $_append: [{
                    $_tag: &quot;i&quot;,
                    class: &quot;material-icons action-delete-icon&quot;,
                    $_append: &quot;cancel&quot;,
                }]
            }]
    	});
    },
    
    updateInputValue: function() {
        var h = this;

        var inputValue = eval(&quot;h.form.getBean().&quot; + h.property + &quot; || &#x27;&#x27;&quot;);
        
        if (h.formatLabel) {
        	try {
        		inputValue = h.formatLabel(h.form.getBean(), h.root.find(h.id(h.property)));
        	} catch (e) {
        		alert(&quot;updateInputValue(): &quot; + e);
        	}
        }
        h.root.find(h.id(h.property)).dom().value = inputValue;
    },    

    setReadOnly: function(trueOrFalse) {
    	var h = this;

    	h.readOnly = trueOrFalse;
    	if (true == trueOrFalse) {
    		h.root.find(h.id(h.property)).readOnly = true;
    		h.actionButton.addClassName(&quot;bardia-not-visible&quot;);
    	} else {
    		h.root.find(h.id(h.property)).readOnly = false;
    		h.actionButton.removeClassName(&quot;bardia-not-visible&quot;);
    	}
    },
});

bardia.form.BooleanField = bardia.oop.Class.inherit(bardia.form.TextField, {

    render: function() {
    	var h = this;
    	
        h.root = $_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-row&quot;,
        });
        
        h.checkBox = new bardia.controlls.CheckBox({
        	onChange: function(value) {
        		h.updateBeanProperty(value);
        	}
        });
        
        h.root.insert(h.checkBox.getWrapper());
        h.root.insert($_element({
        	$_tag: &quot;div&quot;,
        	id: h.id(&quot;label&quot;),
        	style: &quot;position:absolute; left:50px; top:13px;&quot;,
        	$_append: h.label || &quot;???&quot; + h.property + &quot;???&quot;
        }));
        
        h.setReadOnly(h.readOnly);
    },

    updateInputValue: function(bean) {
        var h = this; 
        h.checkBox.setValue(eval(&quot;bean.&quot; + h.property) || false);
    },

    setReadOnly: function(trueOrFalse) {
    	var h = this;

    	h.readOnly = trueOrFalse;
    	h.checkBox.setReadOnly(trueOrFalse);
    },

    validate: function() {
    	var h = this;
    	    	
    	return true;
    },
});

bardia.form.StateField = bardia.oop.Class.inherit(bardia.form.TextField, {

    render: function() {
    	var h = this;

        h.root = $_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-row&quot;,
        });

        h.stateBox = new bardia.controlls.StateBox({
        	readOnly: h.readOnly,
        	width: h.width || 50,
        	states: h.states,
        	onChange: function(value, name) {        		
        		h.updateBeanProperty(value);
        		h.label = name;
                h.applyAttributes();
        	}
        });

        h.root.insert(h.stateBox.getWrapper());
        
        h.root.insert($_element({
        	$_tag: &quot;div&quot;,
        	id: h.id(&quot;label&quot;),
        	style: &quot;position:absolute; left:&quot; + (h.width || 50 + 25) + &quot;px; top:13px;&quot;,
        	$_append: h.label || &quot;???&quot; + h.property + &quot;???&quot;
        }));

        h.setReadOnly(h.readOnly);
    },

    updateInputValue: function(bean) {
        var h = this; 
        h.stateBox.setValue(eval(&quot;bean.&quot; + h.property) || false);
    },

    setReadOnly: function(trueOrFalse) {
    	var h = this;

    	h.readOnly = trueOrFalse;
    	h.stateBox.setReadOnly(trueOrFalse);
    },

});

bardia.form.IntegerField = bardia.oop.Class.inherit(bardia.form.TextField, {

	prepareMask: function() {
		var h = this;

		var parser = new NumberParser();
		parser.decimalDigits = 0;

		var mask = new NumberMask(parser, h.root.find(h.id(h.property)).dom());
		mask.allowNegative = true;

		mask.updateFunction = function(_mask) {			
			h.updateBeanProperty(_mask.control.value);
		}
	}
});
bardia.form.FileField = bardia.oop.Class.inherit(bardia.form.ActionField, {

    /**
     *  
     */
    displayButton: function() {
    	var h = this;

    	return $_element({
    		$_tag: &quot;div&quot;,
    		style: &quot;position:absolute; bottom:0px; left:170px; display:&quot; + ((h.readOnly==true)?&quot;none&quot;:&quot;flex&quot;) + &quot;; flex-direction:row&quot;,
    		$_append: [{
                $_tag: &quot;button&quot;,
                class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
                $_on: {
                    click: function(e) {
                    	h.root.find(h.serial).dom().click();
                    }
                },
                $_append: [{
                    $_tag: &quot;i&quot;,
                    class: &quot;material-icons action-icon&quot;,
                    $_append: &quot;file_upload&quot;,
                }]
            }, {
                $_tag: &quot;button&quot;,
                class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
                $_on: {
                    click: function(e) {
                    	h.updateBeanProperty(undefined);
                    	h.updateInputValue(h.form.getBean());
                    }
                },
                $_append: [{
                    $_tag: &quot;i&quot;,
                    class: &quot;material-icons action-delete-icon&quot;,
                    $_append: &quot;cancel&quot;,
                }]
            }, {
    			$_tag: &quot;form&quot;,
    		    action: h.uploadAction || bardia.uploadAction,
    		    method: &quot;POST&quot;,
    		    target: h.serial,
    		    style: &quot;display:none; width:0px; height:0px&quot;,
    		    $_append: [{
    				$_tag: &quot;input&quot;,
    				type: &quot;file&quot;,
    				name: &quot;fileName_&quot; + h.serial,
    				id: h.serial,
    				style: &quot;display:none&quot;,
    				$_on: {
    					&quot;change&quot;: function() {
    						h.form.openProgress();

    						var form = new FormData();
    							form.append(&quot;file&quot;, h.root.find(h.serial).dom().files[0]);

    						var xhr = new XMLHttpRequest();    						

    						xhr.upload.addEventListener(&quot;progress&quot;, function(e) {
    							var pc = parseInt(100 - (e.loaded / e.total * 100));
    							h.form.setProgressLabel(&quot;&quot; + (100 - pc) + &quot; %&quot;);
    						}, false);

    						xhr.onreadystatechange = function (evt) {
    							if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) {
    								h.form.closeProgress();

    								var createdFile = JSON.parse(xhr.responseText);						
    			                    	h.updateBeanProperty(createdFile);
    			                    	h.updateInputValue(h.form.getBean());
    			                    	h.root.find(h.serial).dom().value = &quot;&quot;;
    							}
    						};

    						var uploadUrl = h.uploadAction || bardia.uploadAction;
    						xhr.open(&quot;POST&quot;, uploadUrl + &quot;?fileName=&quot; + h.root.find(h.serial).dom().files[0].name, true);
    						
    						xhr.send(form);
    					}
    				}
    			}]
            }]
    	});
    	
    	/*
    	return $_element({
            $_tag: &quot;button&quot;,
            class: &quot;mdl-button mdl-js-button mdl-button--icon mdl-button--colored&quot;,
            $_on: {
                click: function(e) {
                	h.root.find(h.serial).dom().click();
                }
            },
            $_append: [{
                $_tag: &quot;i&quot;,
                class: &quot;material-icons action-icon&quot;,
                $_append: &quot;file_upload&quot;,
            }, {
    			$_tag: &quot;form&quot;,
    		    action: h.uploadAction || bardia.uploadAction,
    		    method: &quot;POST&quot;,
    		    target: h.serial,
    		    style: &quot;display:none; width:0px; height:0px&quot;,
    		    $_append: [{
    				$_tag: &quot;input&quot;,
    				type: &quot;file&quot;,
    				name: &quot;fileName_&quot; + h.serial,
    				id: h.serial,
    				style: &quot;display:none&quot;,
    				$_on: {
    					&quot;change&quot;: function() {
    						h.form.openProgress();

    						var form = new FormData();
    							form.append(&quot;file&quot;, h.root.find(h.serial).dom().files[0]);

    						var xhr = new XMLHttpRequest();    						

    						xhr.upload.addEventListener(&quot;progress&quot;, function(e) {
    							var pc = parseInt(100 - (e.loaded / e.total * 100));
    							h.form.setProgressLabel(&quot;&quot; + (100 - pc) + &quot; %&quot;);
    						}, false);

    						xhr.onreadystatechange = function (evt) {
    							if (xhr.readyState == 4 &amp;&amp; xhr.status == 200) {
    								h.form.closeProgress();

    								var createdFile = JSON.parse(xhr.responseText);						
    			                    	h.updateBeanProperty(createdFile);
    			                    	h.updateInputValue(h.form.getBean());
    			                    	h.root.find(h.serial).dom().value = &quot;&quot;;
    							}
    						};

    						var uploadUrl = h.uploadAction || bardia.uploadAction;
    						xhr.open(&quot;POST&quot;, uploadUrl + &quot;?fileName=&quot; + h.root.find(h.serial).dom().files[0].name, true);
    						
    						xhr.send(form);
    					}
    				}
    			}]
    		}]
        });
    	*/
    },
    
    updateInputValue: function(bean) {
        var h = this;

        var file = eval(&quot;bean.&quot; + h.property + &quot; || {name:&#x27;&#x27;}&quot;);
        h.root.find(h.id(h.property)).dom().value = file.name;
    },
});



bardia.form.TextAreaField = bardia.oop.Class.inherit(bardia.form.TextField, {

    render: function() {
        var h = this;

        h.root = $_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-row&quot;,
            style: &quot;height:60px&quot;,
            $_append: [{
                $_tag: &quot;textarea&quot;,
                class: &quot;form-text-input form-textarea&quot;,
                style: h.style || &quot;&quot;,
                required: false,
                maxLength: h.maxLength || 255,
                id: h.id(h.property),
                $_on: {
                    change: function(e) {
                        h.updateBeanProperty(e.target.value);
                    },
                    focus: function(e) {
                    	if (h.readOnly == true) {
                    		e.stopPropagation();
                    		e.target.blur();
                    	} else {
                    		if (h.onFocus) {
                    			h.onFocus();
                    		}
                    	}
                    },
                    blur: function() {
                    	if (h.onBlur) {
                    		h.onBlur();
                    	}
                    }
                }
            }, {
                $_tag: &quot;label&quot;,
                class: &quot;form-text-input-label&quot;,
                id: h.id(&quot;label&quot;),
                $_append: h.label,
                $_on: {
                	click: function() {
                		h.root.find(h.id(h.property)).dom().focus();
                	}
                }
            }]
        });
        
        h.setReadOnly(h.readOnly);
        h.setVisible(h.visible);
        h.setRequired(h.required);
        
        h.prepareMask();
    },
});
bardia.form.TimeSecField = bardia.oop.Class.inherit(bardia.form.TextField, {

	prepareMask: function() {
		var h = this;

		var mask = new InputMask(&quot;##:##&quot;, h.root.find(h.id(h.property)).dom());

		mask.updateFunction = function(_mask) {
			h.updateBeanProperty(_mask.control.value);
		}
	},
	
    updateBeanProperty: function(v) {
        var h = this;        
        
        var value = v.split(&quot;:&quot;);

        var sec1 = parseInt(value[0]) * 60;
        var sec2 = parseInt(value[1]);
        
        if (isNaN(sec1)) {
        	sec1 = 0;
        }
        
        if (isNaN(sec2)) {
        	sec2 = 0;
        }

        var sec = sec1 + sec2;

        eval(&quot;h.form.getBean().&quot; + h.property + &quot; = sec;&quot;);

		if (h.onChange) {
			h.onChange(value);
		}
    },

    updateInputValue: function() {
        var h = this;

        var v = eval(&quot;h.form.getBean().&quot; + h.property + &quot; || 0&quot;);

        v = parseInt(v);
        
        var hours = ((v - (v%60)) / 60);
        var minutes = (v % 60);
        
        if (hours &lt; 10) {
        	hours = &quot;0&quot; + hours;
        }

        if (minutes &lt; 10) {
        	minutes = &quot;0&quot; + minutes;
        }
        
        console.log(&quot;updateInputValue() -&gt;&quot; + hours + &quot;:&quot; + minutes);

        h.root.find(h.id(h.property)).dom().value = hours + &quot;:&quot; + minutes;
    },
});
bardia.form.PasswordField = bardia.oop.Class.inherit(bardia.form.TextField, {

    render: function() {
        var h = this;

        h.root = $_element({
            $_tag: &quot;div&quot;,
            class: &quot;form-row&quot;,
            $_append: [{
                $_tag: &quot;input&quot;,
                class: &quot;form-text-input&quot;,
                type: &quot;password&quot;,
                required: false,
                id: h.id(h.property),
                $_on: {
                    change: function(e) {
                        h.updateBeanProperty(e.target.value);
                    },
                    focus: function(e) {
                    	if (h.readOnly == true) {
                    		e.stopPropagation();
                    		e.target.blur();
                    	}
                    }
                }
            }, {
                $_tag: &quot;label&quot;,
                class: &quot;form-text-input-label&quot;,
                id: h.id(&quot;label&quot;),
                $_append: h.label,
                $_on: {
                	click: function() {
                		h.root.find(h.id(h.property)).dom().focus();
                	}
                }
            }]
        });
        
        h.setReadOnly(h.readOnly);
        h.setVisible(h.visible);
        h.setRequired(h.required);
        
        h.prepareMask();
    },
});

bardia.form.CurrencyField = bardia.oop.Class.inherit(bardia.form.TextField, {

	prepareMask: function() {
		var h = this;

		var parser = new NumberParser();
		parser.decimalDigits = 2;
		parser.decimalSeparator = &quot;.&quot;;
		//parser.currencySymbol = h.currencySymbol || &quot;PLN&quot;;
		parser.useCurrency = false;

		var mask = new NumberMask(parser, h.root.find(h.id(h.property)).dom());
		mask.allowNegative = true;

		mask.updateFunction = function(_mask) {
			h.updateBeanProperty(_mask.control.value);
		}
	}
});
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
